import{r as k,j as e}from"./ui-he1BrmUV.js";import{u as ke}from"./useQuery-8Q4NGJXg.js";import{g as ne,f as Z,E as Ue,F as Ke,L as C,I as $,B as N,G as Qe,i as ce,h as he,U as I,q as ge,k as ue,C as y,a as z,e as P,l as ie,X as pe,b as w,O as je,Q as He,Z as Ce,P as Y,T as We,d as Se,D as qe,m as Me,y as _e,n as Re,V as Ge,j as Ze,W as Xe,u as Je,K as Ne}from"./index-DuN0lgRM.js";import{d as Ye}from"./services-B9yTTPPJ.js";import{f as ee,g as es,a as ss}from"./categories-CJOmrs8V.js";import{T as K}from"./textarea-DkRiY90a.js";import{T as Ae,a as De,b as O,c as U}from"./tabs-DliDjwDz.js";import{S as se,a as te,b as ae,c as re,d as T}from"./select-Dsr1XXMV.js";import{B as _}from"./badge-XIet1yjD.js";import{S as X}from"./star-CvOc0Adm.js";import{E as le}from"./euro-D1TELppd.js";import{C as W}from"./calendar-fP40gq0Q.js";import{S as ts}from"./switch-CcB-tS5F.js";import{U as Te}from"./user-plus-DO7OyrfC.js";import{S as as}from"./settings-C2twR9TG.js";import{L as rs}from"./lock-yloB4B-T.js";import{B as xe}from"./brain-BNSR0LsA.js";import{T as ye,C as is}from"./triangle-alert-DKixY3pn.js";import{L as ls}from"./lightbulb-BsZuHBMG.js";import{T as ns}from"./trending-up-9DBHzkPd.js";import{A as ze}from"./award-DXJpko5Q.js";import{M as G}from"./message-circle-Byow6ged.js";import{A as cs}from"./availability-calendar-aK51GAbd.js";import{M as Pe}from"./map-pin-DW_65pa3.js";import{P as ds}from"./phone-BHCOX3wb.js";import{C as $e}from"./clock-BPYlVGDj.js";import{C as os}from"./circle-alert-wKiTOIse.js";import{F as ms}from"./file-text-CHHFdlGF.js";import"./vendor-D3F3s8fL.js";import"./index-BelvN6Su.js";import"./chevron-up-5X_wZTlk.js";import"./calendar-B_31C03-.js";import"./en-US-oEpl4HuW.js";import"./chevron-left-CFufmgdb.js";import"./trash-2-CDWFDh_6.js";import"./save-BXRS5Ghs.js";import"./fr-Qfl_UVRO.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=ne("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ne("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=ne("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=ne("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);function Ee({missionId:m,onSuccess:S}){const{user:p}=Z(),[x,g]=k.useState({amount:"",timeline:"",proposal:""}),d=Ue("/api/bids",{successMessage:"🚀 Offre envoyée avec succès !",errorContext:"Soumission d'offre",invalidateQueries:[["/api/missions",m],["/api/missions"],["/api/users",p?.id,"bids"]],onSuccess:()=>{g({amount:"",timeline:"",proposal:""}),S()}}),f=Ke({onSubmit:async l=>{d.mutate(l)},validateBeforeSubmit:Qe.validateBid}),a=l=>{if(l.preventDefault(),!p){f.handleError(new Error("Vous devez être connecté pour postuler"),"Authentification requise");return}f.handleSubmit({...x,missionId:m,providerId:p.id,providerName:p.name,amount:x.amount,rating:p.rating||"5.0"})},t=(l,j)=>{g(q=>({...q,[l]:j}))};return!p||p.type!=="provider"?null:e.jsx("div",{className:"bg-white rounded-lg p-1",children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"amount",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"💰"}),e.jsx("span",{children:"Prix proposé (€)"})]}),e.jsx($,{id:"amount",type:"number",step:"0.01",min:"0",placeholder:"Ex: 2500",value:x.amount,onChange:l=>t("amount",l.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-green-500 focus:ring-2 focus:ring-green-100 transition-colors",required:!0,"data-testid":"input-bid-price"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"timeline",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsx("span",{children:"Délai de livraison"})]}),e.jsx($,{id:"timeline",type:"text",placeholder:"Ex: 4 semaines",value:x.timeline,onChange:l=>t("timeline",l.target.value),className:"h-11 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition-colors",required:!0,"data-testid":"input-bid-timeline"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"proposal",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📝"}),e.jsx("span",{children:"Décrivez votre proposition"})]}),e.jsx(K,{id:"proposal",placeholder:"Expliquez votre approche, votre expérience pertinente et ce que vous allez concrètement livrer pour cette mission...",value:x.proposal,onChange:l=>t("proposal",l.target.value),className:"min-h-[120px] rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-100 resize-none transition-colors",required:!0,"data-testid":"textarea-bid-proposal"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(N,{type:"submit",className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",disabled:d.isPending||f.isSubmitting,"data-testid":"button-submit-bid",children:d.isPending||f.isSubmitting?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🚀"}),e.jsx("span",{children:"Envoyer ma candidature"})]})})})]})})}function ps({missionId:m,onSuccess:S}){const{user:p}=Z(),{toast:x}=ce(),g=he(),[d,f]=k.useState(!1),[a,t]=k.useState({amount:"",timeline_days:"",message:""}),[l,j]=k.useState([{name:p?.name||"",role:"Chef d'équipe",experience:"5+ années",isLead:!0,rating:4.5}]),q=()=>{const c={name:"",role:"",experience:"",isLead:!1,rating:4};j([...l,c])},M=(c,b,i)=>{const s=[...l];s[c]={...s[c],[b]:i},j(s)},R=c=>{if(c===0)return;const b=l.filter((i,s)=>s!==c);j(b)},D=async c=>{if(c.preventDefault(),!p){x({title:"Erreur",description:"Vous devez être connecté pour soumettre une offre",variant:"destructive"});return}if(!a.amount||!a.timeline_days||!a.message){x({title:"Erreur",description:"Veuillez remplir tous les champs obligatoires",variant:"destructive"});return}if(l.length<2){x({title:"Erreur",description:"Une équipe doit avoir au moins 2 membres",variant:"destructive"});return}if(l.filter(i=>!i.name||!i.role||!i.experience).length>0){x({title:"Erreur",description:"Veuillez compléter les informations de tous les membres de l'équipe",variant:"destructive"});return}f(!0);try{const i={members:l,total_budget:parseInt(a.amount),estimated_timeline:parseInt(a.timeline_days),description:a.message},u=await(await je("POST","/api/bids",{mission_id:parseInt(m),amount:a.amount,timeline_days:parseInt(a.timeline_days),message:a.message,bid_type:"team",team_composition:i,team_lead_id:p.id})).json();x({title:"✅ Candidature d'équipe soumise !",description:`Votre équipe de ${l.length} membres a été proposée avec succès.`}),g.invalidateQueries({queryKey:["mission-detail",m]}),g.invalidateQueries({queryKey:["missions"]}),S()}catch(i){console.error("Erreur soumission candidature équipe:",i),x({title:"Erreur",description:i instanceof Error?i.message:"Impossible de soumettre la candidature",variant:"destructive"})}finally{f(!1)}};return!p||p.type!=="provider"?null:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Candidature d'équipe"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Présentez votre équipe pré-constituée pour cette mission"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Composition de l'équipe"]}),e.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:q,"data-testid":"button-add-member",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),e.jsx("div",{className:"space-y-3",children:l.map((c,b)=>e.jsxs(y,{className:`${c.isLead?"ring-2 ring-purple-200 bg-purple-50":"bg-gray-50"}`,children:[e.jsx(z,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{className:"text-sm flex items-center gap-2",children:c.isLead?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4 text-purple-600"}),"Chef d'équipe"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4"}),"Membre ",b]})}),!c.isLead&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(b),"data-testid":`button-remove-member-${b}`,children:e.jsx(pe,{className:"w-4 h-4"})})]})}),e.jsxs(w,{className:"pt-0 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Nom complet *"}),e.jsx($,{placeholder:"Nom du membre",value:c.name,onChange:i=>M(b,"name",i.target.value),disabled:c.isLead,"data-testid":`input-member-name-${b}`})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Rôle/Spécialité *"}),e.jsx($,{placeholder:"Ex: Développeur Frontend",value:c.role,onChange:i=>M(b,"role",i.target.value),"data-testid":`input-member-role-${b}`})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Expérience *"}),e.jsxs(se,{value:c.experience,onValueChange:i=>M(b,"experience",i),children:[e.jsx(te,{"data-testid":`select-member-experience-${b}`,children:e.jsx(ae,{placeholder:"Niveau d'expérience"})}),e.jsxs(re,{children:[e.jsx(T,{value:"1-2 années",children:"1-2 années"}),e.jsx(T,{value:"3-5 années",children:"3-5 années"}),e.jsx(T,{value:"5+ années",children:"5+ années"}),e.jsx(T,{value:"10+ années",children:"10+ années"})]})]})]})]})]},b))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"team-amount",className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Prix total équipe (€) *"]}),e.jsx($,{id:"team-amount",type:"number",placeholder:"15000",min:"100",value:a.amount,onChange:c=>t(b=>({...b,amount:c.target.value})),"data-testid":"input-team-amount"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Montant global pour toute l'équipe"})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"team-timeline",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Délai (jours) *"]}),e.jsx($,{id:"team-timeline",type:"number",placeholder:"30",min:"1",value:a.timeline_days,onChange:c=>t(b=>({...b,timeline_days:c.target.value})),"data-testid":"input-team-timeline"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"team-message",className:"text-base font-medium",children:"Proposition détaillée *"}),e.jsx(K,{id:"team-message",placeholder:"Décrivez comment votre équipe va réaliser cette mission, la répartition des tâches, votre méthodologie...",rows:5,value:a.message,onChange:c=>t(b=>({...b,message:c.target.value})),"data-testid":"textarea-team-message"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Détaillez la stratégie de votre équipe pour cette mission"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 border",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Récapitulatif de l'équipe"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Membres:"}),e.jsxs(_,{variant:"secondary",children:[l.length," personnes"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Budget total:"}),e.jsxs(_,{variant:"secondary",children:[a.amount||"0","€"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Délai:"}),e.jsxs(_,{variant:"secondary",children:[a.timeline_days||"0"," jours"]})]})]})]}),e.jsx(N,{type:"submit",className:"w-full bg-purple-600 hover:bg-purple-700",disabled:d,"data-testid":"button-submit-team-bid",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Soumission en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Soumettre la candidature d'équipe"]})})]})}function hs({missionId:m,onSuccess:S}){const{user:p}=Z(),{toast:x}=ce(),g=he(),[d,f]=k.useState(!1),[a,t]=k.useState({name:"",description:"",estimated_budget:"",estimated_timeline_days:"",max_members:"5",visibility:"public",auto_accept:!0}),[l,j]=k.useState([{title:"",description:"",skills:[],min_experience:1,priority:"medium"}]),q=()=>{const i={title:"",description:"",skills:[],min_experience:1,priority:"medium"};j([...l,i])},M=(i,s,u)=>{const v=[...l];v[i]={...v[i],[s]:u},j(v)},R=i=>{if(l.length<=1)return;const s=l.filter((u,v)=>v!==i);j(s)},D=(i,s)=>{if(!s.trim())return;const u=[...l],v=u[i].skills;v.includes(s.trim())||(u[i].skills=[...v,s.trim()],j(u))},c=(i,s)=>{const u=[...l];u[i].skills=u[i].skills.filter((v,Q)=>Q!==s),j(u)},b=async i=>{if(i.preventDefault(),!p){x({title:"Erreur",description:"Vous devez être connecté pour créer une équipe ouverte",variant:"destructive"});return}if(!a.name||!a.description||!a.estimated_budget||!a.estimated_timeline_days){x({title:"Erreur",description:"Veuillez remplir tous les champs obligatoires",variant:"destructive"});return}const s=l.filter(u=>u.title.trim());if(s.length===0){x({title:"Erreur",description:"Veuillez définir au moins un rôle recherché",variant:"destructive"});return}f(!0);try{const v=await(await je("POST","/api/open-teams",{mission_id:parseInt(m),name:a.name,description:a.description,estimated_budget:parseInt(a.estimated_budget)*100,estimated_timeline_days:parseInt(a.estimated_timeline_days),max_members:parseInt(a.max_members),visibility:a.visibility,auto_accept:a.auto_accept,required_roles:s,members:[{user_id:p.id,name:p.name,role:"Initiateur",experience_years:5,rating:4.5,joined_at:new Date().toISOString()}]})).json();x({title:"🚀 Équipe ouverte créée !",description:`${a.name} est maintenant ouverte au recrutement.`}),g.invalidateQueries({queryKey:["mission-detail",m]}),g.invalidateQueries({queryKey:["open-teams"]}),S()}catch(u){console.error("Erreur création équipe ouverte:",u),x({title:"Erreur",description:u instanceof Error?u.message:"Impossible de créer l'équipe ouverte",variant:"destructive"})}finally{f(!1)}};return!p||p.type!=="provider"?null:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center justify-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Créer une équipe ouverte"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Initiez une équipe où d'autres prestataires peuvent vous rejoindre"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"team-name",className:"text-base font-medium",children:"Nom de l'équipe *"}),e.jsx($,{id:"team-name",placeholder:"Ex: Équipe Développement Web Pro",value:a.name,onChange:i=>t(s=>({...s,name:i.target.value})),"data-testid":"input-team-name"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"team-description",className:"text-base font-medium",children:"Description de l'équipe *"}),e.jsx(K,{id:"team-description",placeholder:"Décrivez votre approche, votre vision pour cette mission...",rows:3,value:a.description,onChange:i=>t(s=>({...s,description:i.target.value})),"data-testid":"textarea-team-description"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"estimated-budget",className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Budget estimé (€) *"]}),e.jsx($,{id:"estimated-budget",type:"number",placeholder:"10000",min:"100",value:a.estimated_budget,onChange:i=>t(s=>({...s,estimated_budget:i.target.value})),"data-testid":"input-estimated-budget"})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"estimated-timeline",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Délai estimé (jours) *"]}),e.jsx($,{id:"estimated-timeline",type:"number",placeholder:"45",min:"1",value:a.estimated_timeline_days,onChange:i=>t(s=>({...s,estimated_timeline_days:i.target.value})),"data-testid":"input-estimated-timeline"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Rôles recherchés"]}),e.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:q,"data-testid":"button-add-role",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"Ajouter"]})]}),e.jsx("div",{className:"space-y-3",children:l.map((i,s)=>e.jsxs(y,{className:"bg-orange-50 border-orange-200",children:[e.jsx(z,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(P,{className:"text-sm",children:["Rôle ",s+1]}),l.length>1&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(s),"data-testid":`button-remove-role-${s}`,children:e.jsx(pe,{className:"w-4 h-4"})})]})}),e.jsxs(w,{className:"pt-0 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Titre du poste *"}),e.jsx($,{placeholder:"Ex: Développeur React",value:i.title,onChange:u=>M(s,"title",u.target.value),"data-testid":`input-role-title-${s}`})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Priorité"}),e.jsxs(se,{value:i.priority,onValueChange:u=>M(s,"priority",u),children:[e.jsx(te,{"data-testid":`select-role-priority-${s}`,children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(T,{value:"high",children:"Haute"}),e.jsx(T,{value:"medium",children:"Moyenne"}),e.jsx(T,{value:"low",children:"Basse"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Description du rôle"}),e.jsx(K,{placeholder:"Décrivez les responsabilités et attentes...",rows:2,value:i.description,onChange:u=>M(s,"description",u.target.value),"data-testid":`textarea-role-description-${s}`})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Compétences requises"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:i.skills.map((u,v)=>e.jsxs(_,{variant:"secondary",className:"flex items-center gap-1",children:[u,e.jsx(pe,{className:"w-3 h-3 cursor-pointer hover:text-red-500",onClick:()=>c(s,v)})]},v))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{placeholder:"Ajouter une compétence...",onKeyPress:u=>{u.key==="Enter"&&(u.preventDefault(),D(s,u.currentTarget.value),u.currentTarget.value="")},"data-testid":`input-role-skill-${s}`}),e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:u=>{const v=u.currentTarget.parentNode?.querySelector("input");v&&(D(s,v.value),v.value="")},children:e.jsx(ue,{className:"w-4 h-4"})})]})]})]})]},s))})]}),e.jsxs(y,{className:"bg-gray-50",children:[e.jsx(z,{children:e.jsxs(P,{className:"text-sm flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Paramètres de l'équipe"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Nombre max de membres"}),e.jsxs(se,{value:a.max_members,onValueChange:i=>t(s=>({...s,max_members:i})),children:[e.jsx(te,{"data-testid":"select-max-members",children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(T,{value:"3",children:"3 membres"}),e.jsx(T,{value:"5",children:"5 membres"}),e.jsx(T,{value:"7",children:"7 membres"}),e.jsx(T,{value:"10",children:"10 membres"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm",children:"Visibilité"}),e.jsxs(se,{value:a.visibility,onValueChange:i=>t(s=>({...s,visibility:i})),children:[e.jsx(te,{"data-testid":"select-visibility",children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(T,{value:"public",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4"}),"Publique"]})}),e.jsx(T,{value:"private",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Privée"]})})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{id:"auto-accept",checked:a.auto_accept,onCheckedChange:i=>t(s=>({...s,auto_accept:i})),"data-testid":"switch-auto-accept"}),e.jsx(C,{htmlFor:"auto-accept",className:"text-sm",children:"Accepter automatiquement les candidatures"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg p-4 border",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Récapitulatif de l'équipe ouverte"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Nom:"}),e.jsx(_,{variant:"secondary",children:a.name||"Non défini"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Budget estimé:"}),e.jsxs(_,{variant:"secondary",children:[a.estimated_budget||"0","€"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Membres max:"}),e.jsxs(_,{variant:"secondary",children:[a.max_members," personnes"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Rôles définis:"}),e.jsxs(_,{variant:"secondary",children:[l.filter(i=>i.title).length," rôles"]})]})]})]}),e.jsx(N,{type:"submit",className:"w-full bg-orange-600 hover:bg-orange-700",disabled:d,"data-testid":"button-submit-open-team",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Création en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Créer l'équipe ouverte"]})})]})}function Fe({missionTitle:m,missionDescription:S,missionBudget:p,missionCategory:x,currentBid:g,providerProfile:d,competitorBids:f=[],onOptimizedBidGenerated:a}){const[t,l]=k.useState(null),[j,q]=k.useState(!1),[M,R]=k.useState(!1),D=async()=>{q(!0),await new Promise(me=>setTimeout(me,2e3));const r=c(m+" "+S),n=c(g.proposal),h=b(r,n),F=f.length>0?f.reduce((me,Oe)=>me+Oe.price,0)/f.length:p,A=i(g.price,F,p),V=s(d.skills,x,d.completedProjects,d.rating),H=u(g.proposal,d),ve=(h+V)/2,be=(A+Q(g.timeline))/2,fe=H*.4+ve*.3+be*.3,Ie=v(fe,f.length),Be=de({keywordRelevance:h,priceCompetitiveness:A,experienceMatch:V,proposal:g.proposal}),Le=oe({rating:d.rating,projects:d.completedProjects,skills:d.skills,price:g.price,avgPrice:F}),Ve=J({keywordRelevance:h,priceCompetitiveness:A,proposal:g.proposal,timeline:g.timeline});l({overallScore:fe,competitivenessScore:be,qualityScore:H,matchScore:ve,winProbability:Ie,recommendations:Be,strengths:Le,weaknesses:Ve,keywordRelevance:h,priceCompetitiveness:A,experienceMatch:V}),q(!1)},c=r=>{const n=["le","la","les","un","une","des","et","ou","mais","donc","or","ni","car"];return r.toLowerCase().split(/[\s,;.!?]+/).filter(h=>h.length>3&&!n.includes(h)).slice(0,10)},b=(r,n)=>{const h=r.filter(F=>n.some(A=>A.includes(F)||F.includes(A)));return Math.min(100,h.length/r.length*100)},i=(r,n,h)=>r>h?20:r<h*.3?40:r<=n*.9?90:r<=n?75:Math.max(30,70-(r-n)/n*50),s=(r,n,h,F)=>{let A=0;const V=r.filter(H=>H.toLowerCase().includes(n.toLowerCase())||n.toLowerCase().includes(H.toLowerCase()));return A+=V.length/Math.max(r.length,1)*40,A+=Math.min(30,h*.5),A+=F/5*30,Math.min(100,A)},u=(r,n)=>{let h=0;r.length>200&&(h+=25),r.length>500&&(h+=15);const A=["expérience","qualité","deadline","livraison","garantie","suivi"].filter(V=>r.toLowerCase().includes(V));return h+=A.length*5,h+=n.rating/5*20,h+=Math.min(20,n.completedProjects*.2),Math.min(100,h)},v=(r,n)=>{let h=r;return n>5?h*=.8:n>10?h*=.6:n<3&&(h*=1.1),Math.min(95,Math.max(5,h))},Q=r=>{const n=parseInt(r);return n<=7?85:n<=14?75:n<=30?65:45},de=r=>{const n=[];return r.keywordRelevance<60&&n.push("Incluez plus de mots-clés spécifiques à la mission dans votre proposition"),r.priceCompetitiveness<50&&n.push("Votre prix semble élevé par rapport à la concurrence, justifiez votre valeur ajoutée"),r.proposal.length<300&&n.push("Développez davantage votre proposition pour montrer votre compréhension du projet"),r.experienceMatch<70&&n.push("Mettez en avant votre expérience pertinente dans ce domaine"),n},oe=r=>{const n=[];return r.rating>=4.5&&n.push("Excellente réputation client"),r.projects>50&&n.push("Grande expérience avec de nombreux projets"),r.price<r.avgPrice*.9&&n.push("Prix très compétitif"),n},J=r=>{const n=[];return r.keywordRelevance<50&&n.push("Faible correspondance avec les mots-clés de la mission"),r.priceCompetitiveness<40&&n.push("Prix potentiellement trop élevé"),r.proposal.length<200&&n.push("Proposition trop courte"),n},E=()=>{const r=`
Bonjour,

Votre projet "${m}" correspond parfaitement à mon expertise. Avec ${d.completedProjects} projets réalisés et une note de ${d.rating}/5, je peux vous garantir une livraison de qualité.

Mon approche pour votre projet :
• Analyse détaillée de vos besoins spécifiques
• Utilisation de mes compétences en ${d.skills.join(", ")}
• Respect strict des délais convenus
• Communication régulière sur l'avancement
• Garantie satisfaction client

Je propose de réaliser ce projet pour ${Math.round(g.price*.95)}€ avec livraison sous ${g.timeline}.

Ma valeur ajoutée : expérience prouvée dans ${x}, méthodologie rigoureuse et engagement qualité.

Disponible pour échanger sur votre projet dès maintenant.

Cordialement
    `.trim();l(n=>n?{...n,optimizedProposal:r}:null),R(!0),a&&a({...g,proposal:r,price:Math.round(g.price*.95)})},L=r=>r>=80?"text-green-600":r>=60?"text-yellow-600":"text-red-600",o=r=>r>=80?"bg-green-100":r>=60?"bg-yellow-100":"bg-red-100";return e.jsxs(y,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"w-6 h-6 text-blue-600"}),e.jsx("span",{children:"Analyse IA de votre offre"}),e.jsxs(_,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),"Smart Algorithm"]})]})}),e.jsxs(w,{className:"space-y-6",children:[!t&&!j&&e.jsx("div",{className:"text-center py-8",children:e.jsxs(N,{onClick:D,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Analyser mon offre avec l'IA"]})}),j&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Analyse en cours avec notre algorithme propriétaire..."})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`p-6 rounded-xl ${o(t.overallScore)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Score Global"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-3xl font-bold ${L(t.overallScore)}`,children:Math.round(t.overallScore)}),e.jsx("span",{className:"text-gray-500",children:"/100"})]})]}),e.jsx(Y,{value:t.overallScore,className:"mb-4"}),e.jsx("div",{className:"flex items-center space-x-4 text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"w-4 h-4 mr-1 text-blue-600"}),e.jsxs("span",{children:["Probabilité de succès: ",Math.round(t.winProbability),"%"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Qualité"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Y,{value:t.qualityScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${L(t.qualityScore)}`,children:Math.round(t.qualityScore)})]})]})}),e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Correspondance"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Y,{value:t.matchScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${L(t.matchScore)}`,children:Math.round(t.matchScore)})]})]})}),e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Compétitivité"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Y,{value:t.competitivenessScore,className:"flex-1 mr-2"}),e.jsx("span",{className:`font-bold ${L(t.competitivenessScore)}`,children:Math.round(t.competitivenessScore)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(y,{children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center text-green-600",children:[e.jsx(Se,{className:"w-5 h-5 mr-2"}),"Forces"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-2",children:t.strengths.map((r,n)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(X,{className:"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:r})]},n))})})]}),e.jsxs(y,{children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center text-orange-600",children:[e.jsx(ye,{className:"w-5 h-5 mr-2"}),"Points d'amélioration"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-2",children:t.weaknesses.map((r,n)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(ye,{className:"w-4 h-4 text-orange-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:r})]},n))})})]})]}),e.jsxs(y,{children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center text-blue-600",children:[e.jsx(ls,{className:"w-5 h-5 mr-2"}),"Recommandations IA"]})}),e.jsx(w,{children:e.jsx("ul",{className:"space-y-3",children:t.recommendations.map((r,n)=>e.jsxs("li",{className:"flex items-start p-3 bg-blue-50 rounded-lg",children:[e.jsx(ns,{className:"w-4 h-4 text-blue-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:r})]},n))})})]}),e.jsx("div",{className:"text-center",children:e.jsxs(N,{onClick:E,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",disabled:M,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Générer une proposition optimisée"]})}),M&&t.optimizedProposal&&e.jsxs(y,{className:"border-purple-200 bg-purple-50",children:[e.jsx(z,{children:e.jsx(P,{className:"text-purple-700",children:"Proposition Optimisée par IA"})}),e.jsxs(w,{children:[e.jsx(K,{value:t.optimizedProposal,readOnly:!0,className:"min-h-[200px] bg-white"}),e.jsx("div",{className:"mt-4 text-sm text-purple-600",children:"✨ Cette proposition a été générée pour maximiser vos chances de succès"})]})]})]})]})]})}function gs({mission:m,user:S,sortedBids:p,showAIAnalyzer:x,setShowAIAnalyzer:g,showBidForm:d,setShowBidForm:f}){const[a,t]=k.useState("individual"),[l,j]=k.useState(!1),[q,M]=k.useState(!1);return e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 md:p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm md:text-base",children:"Candidater à cette mission"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Choisissez votre mode de candidature"})]})]}),e.jsxs(Ae,{value:a,onValueChange:R=>t(R),className:"w-full",children:[e.jsxs(De,{className:"grid w-full grid-cols-3 mb-4",children:[e.jsxs(O,{value:"individual",className:"text-xs md:text-sm data-[testid=tab-individual]","data-testid":"tab-individual",children:[e.jsx(ie,{className:"w-4 h-4 mr-1"}),"Solo"]}),e.jsxs(O,{value:"team",className:"text-xs md:text-sm","data-testid":"tab-team",children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"Équipe"]}),e.jsxs(O,{value:"open_team",className:"text-xs md:text-sm","data-testid":"tab-open-team",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Équipe Ouverte"]})]}),e.jsx(U,{value:"individual",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-blue-50 border-blue-200",children:[e.jsx(z,{className:"pb-3",children:e.jsxs(P,{className:"text-sm flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Candidature individuelle"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Candidatez seul à cette mission avec votre expertise."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(N,{onClick:()=>g(!x),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-sm",size:"default","data-testid":"button-ai-analyzer",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Analyser avec l'IA"]}),e.jsxs(N,{onClick:()=>f(!d),className:"w-full bg-green-600 hover:bg-green-700 text-sm",size:"default","data-testid":"button-submit-individual",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),d?"Masquer le formulaire":"Soumettre une offre"]})]}),x&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Fe,{missionTitle:m.title,missionDescription:m.description,missionBudget:parseFloat(m.budget||"0"),missionCategory:m.category,currentBid:{price:0,timeline:"",proposal:""},providerProfile:{rating:4.5,completedProjects:25,skills:["React","Node.js","TypeScript"],portfolio:[]},competitorBids:p,onOptimizedBidGenerated:R=>{f(!0)}})}),d&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(Ee,{missionId:m.id,onSuccess:()=>{f(!1),g(!1)}})})]})]})}),e.jsx(U,{value:"team",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-purple-50 border-purple-200",children:[e.jsx(z,{className:"pb-3",children:e.jsxs(P,{className:"text-sm flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Candidature d'équipe"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Candidatez avec une équipe pré-constituée que vous dirigez."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-white rounded-lg border",children:[e.jsx(X,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Vous êtes le chef d'équipe"})]}),e.jsxs(N,{onClick:()=>j(!l),className:"w-full bg-purple-600 hover:bg-purple-700 text-sm",size:"default","data-testid":"button-submit-team",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),l?"Masquer le formulaire":"Candidater en équipe"]})]}),l&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(ps,{missionId:m.id,onSuccess:()=>{j(!1)}})})]})]})}),e.jsx(U,{value:"open_team",className:"space-y-4 mt-0",children:e.jsxs(y,{className:"bg-orange-50 border-orange-200",children:[e.jsx(z,{className:"pb-3",children:e.jsxs(P,{className:"text-sm flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Équipe ouverte"]})}),e.jsxs(w,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Créez une équipe ouverte où d'autres prestataires peuvent vous rejoindre."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(Te,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{children:"Recrutement ouvert"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(xs,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{children:"Collaboration"})]})]}),e.jsxs(N,{onClick:()=>M(!q),className:"w-full bg-orange-600 hover:bg-orange-700 text-sm",size:"default","data-testid":"button-submit-open-team",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),q?"Masquer le formulaire":"Créer une équipe ouverte"]})]}),q&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg border",children:e.jsx(hs,{missionId:m.id,onSuccess:()=>{M(!1)}})})]})]})})]})]})}function js({providerId:m,providerName:S,isOpen:p,onClose:x}){const{toast:g}=ce(),{data:d,isLoading:f}=ke({queryKey:["/api/providers",m,"profile"],enabled:!!m&&p}),a=t=>Array.from({length:5},(l,j)=>e.jsx(X,{className:`w-4 h-4 ${j<t?"text-yellow-400 fill-current":"text-gray-300"}`},j));return!p||!m?null:e.jsx(qe,{open:p,onOpenChange:x,children:e.jsxs(Me,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(_e,{children:e.jsx(Re,{asChild:!0,children:e.jsx(Ge,{children:"Profil du prestataire"})})}),e.jsx("div",{className:"p-6"}),f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):d?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:d.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),d.location||"Localisation non spécifiée"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Membre depuis ",ee(d.joinedAt)]})]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:d.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end mb-2",children:[e.jsx("div",{className:"flex items-center mr-2",children:a(Math.round(parseFloat(d.rating)))}),e.jsx("span",{className:"text-xl font-bold",children:d.rating})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[d.totalProjects," projets réalisés"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.skills.map((t,l)=>e.jsx(_,{variant:"secondary",children:t},l))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs(N,{className:"bg-blue-500 hover:bg-blue-600 text-white",onClick:()=>{window.location.href=`/messages?contact=${m}&name=${encodeURIComponent(S)}`},children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Message"]}),e.jsxs(N,{variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",onClick:()=>{g({title:"Contacter le prestataire",description:`Appelez ${S} pour discuter du projet`})},children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),"Appeler"]}),e.jsxs(N,{className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white",onClick:()=>{g({title:"Réservation de créneau",description:`Fonctionnalité de réservation avec ${S} en cours de développement`})},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Réserver un créneau"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Réalisations récentes"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:d.portfolio.slice(0,4).map(t=>e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[t.images.length>0&&e.jsx("img",{src:t.images[0],alt:t.title,className:"w-full h-32 object-cover rounded-lg mb-3"}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_,{variant:"outline",children:t.category}),e.jsx("span",{className:"text-xs text-gray-500",children:ee(t.completedAt)})]})]})},t.id))}),d.portfolio.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune réalisation disponible pour le moment"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx($e,{className:"w-5 h-5 mr-2"}),"Disponibilités"]}),e.jsx(y,{children:e.jsx(w,{className:"p-4",children:e.jsx(cs,{readOnly:!0,initialAvailability:d.availability||[]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Avis clients (",d.evaluations.length,")"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:d.evaluations.map(t=>e.jsx(y,{children:e.jsxs(w,{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-1",children:[a(t.rating),e.jsx("span",{className:"ml-2 font-medium",children:t.clientName})]}),e.jsx("span",{className:"text-xs text-gray-500",children:ee(t.createdAt)})]})}),e.jsx("p",{className:"text-gray-700 mb-3",children:t.comment}),t.photos&&t.photos.length>0&&e.jsx("div",{className:"flex space-x-2",children:t.photos.slice(0,3).map((l,j)=>e.jsx("img",{src:l,alt:`Photo ${j+1}`,className:"w-16 h-16 object-cover rounded-lg"},j))})]})},t.id))}),d.evaluations.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun avis client pour le moment"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(N,{onClick:x,children:"Fermer"})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Profil non trouvé"})})]})})}function vs({bidId:m,bidderName:S,isOpen:p,onClose:x}){const{user:g}=Z(),{toast:d}=ce(),f=he(),[a,t]=k.useState(null),[l,j]=k.useState(""),q=Ze({mutationFn:async c=>(await je("POST","/api/bids/respond",c)).json(),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/missions"]});const c=a==="accept"?"acceptée":a==="reject"?"déclinée":"en négociation";d({title:"Réponse envoyée !",description:`Votre réponse (${c}) a été envoyée au prestataire. Il recevra une notification.`}),setTimeout(()=>{alert(`Confirmation : Votre réponse "${c}" a bien été envoyée à ${S}. Un email de confirmation lui a été envoyé.`)},500),x(),t(null),j("")},onError:c=>{d({title:"Erreur",description:c.message||"Une erreur est survenue",variant:"destructive"})}}),M=c=>{if(c.preventDefault(),!a){d({title:"Action requise",description:"Veuillez choisir une action",variant:"destructive"});return}if(a==="negotiate"&&!l.trim()){d({title:"Message requis",description:"Veuillez ajouter un message pour négocier",variant:"destructive"});return}q.mutate({bidId:m,status:a,message:l.trim()||null,clientResponse:a})},R=c=>{switch(c){case"accept":return`Bonjour ${S},

Nous avons le plaisir de vous informer que votre offre a été retenue pour ce projet. Nous allons procéder à la mise en place du contrat.

Cordialement`;case"reject":return`Bonjour ${S},

Nous vous remercions pour votre offre. Malheureusement, nous avons décidé de retenir une autre proposition pour ce projet.

Cordialement`;case"negotiate":return`Bonjour ${S},

Votre offre nous intéresse. Cependant, nous aimerions discuter de certains points :

- 
- 

Êtes-vous ouvert à la négociation ?

Cordialement`}},D=c=>{t(c),j(R(c))};return e.jsx(qe,{open:p,onOpenChange:x,children:e.jsxs(Me,{className:"sm:max-w-2xl bg-white border shadow-lg",children:[e.jsx(_e,{children:e.jsxs(Re,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(G,{className:"w-6 h-6 text-blue-500"}),"Répondre à l'offre de ",S]})}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Choisissez votre réponse :"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>D("accept"),className:`p-4 rounded-xl border-2 transition-all ${a==="accept"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`,children:[e.jsx(Se,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("div",{className:"font-semibold",children:"Accepter"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Retenir cette offre"})]}),e.jsxs("button",{type:"button",onClick:()=>D("negotiate"),className:`p-4 rounded-xl border-2 transition-all ${a==="negotiate"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx(G,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:"Négocier"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Demander des ajustements"})]}),e.jsxs("button",{type:"button",onClick:()=>D("reject"),className:`p-4 rounded-xl border-2 transition-all ${a==="reject"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 hover:border-red-300"}`,children:[e.jsx(is,{className:"w-8 h-8 mx-auto mb-2 text-red-500"}),e.jsx("div",{className:"font-semibold",children:"Décliner"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ne pas retenir"})]})]})]}),a&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"message",className:"text-sm font-semibold text-gray-800",children:["Message à ",S]}),e.jsx(K,{id:"message",value:l,onChange:c=>j(c.target.value),placeholder:"Votre message...",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(N,{type:"button",variant:"outline",onClick:x,className:"flex-1",disabled:q.isPending,children:"Annuler"}),e.jsx(N,{type:"submit",className:"flex-1 bg-blue-500 hover:bg-blue-600",disabled:!a||q.isPending,children:q.isPending?"Envoi...":"Envoyer la réponse"})]})]})]})})}function tt(){console.log("🔍 MissionDetailPage - Démarrage du composant");const{user:m}=Z(),S=Xe(),[,p]=Je(),x=S.id;console.log("🔍 MissionDetailPage - Params reçus:",{missionId:x,user:m?.name});const[g,d]=k.useState("overview"),[f,a]=k.useState(null),[t,l]=k.useState(""),[j,q]=k.useState(null),[M,R]=k.useState(""),[D,c]=k.useState(!1),[b,i]=k.useState(!1),{data:s,isLoading:u,error:v}=ke({queryKey:["mission-detail",x],queryFn:async()=>{if(console.log("🔍 Chargement mission avec mappers ID:",x),!x||x==="undefined"||x==="null")throw new Error("ID de mission invalide");try{const o=await Ye.getMissionById(x);return console.log("✅ Mission normalisée chargée:",o.title),o}catch(o){throw console.error("❌ Erreur lors du chargement de la mission:",o),o}},enabled:!!x,retry:1,retryDelay:2e3,staleTime:3e4});k.useEffect(()=>{if(s){document.title=`${s.title} - SwipDEAL`;const o=document.querySelector('meta[name="description"]');o&&o.setAttribute("content",`Mission: ${s.title} - Budget: ${s.budgetDisplay} - ${s.description.slice(0,150)}...`)}},[s]);const Q=()=>{if(!s||!m)return"overview";const r=[...s.bids||[]].sort((h,F)=>h.amount-F.amount),n=s.teamRequirements&&s.teamRequirements.length>0;return m.type==="client"&&s.clientName===m.name&&r.length>0?"bids":n&&m.type==="provider"&&s.clientName!==m.name?"team":"overview"};k.useEffect(()=>{if(console.log("🔄 useEffect - Mission ou user changé:",{missionId:s?.id,userId:m?.id,missionExists:!!s}),s){const o=Q();console.log("📊 Onglet par défaut calculé:",o),d(o),a(null),l(""),q(null),R(""),c(!1),i(!1)}},[s?.id,m?.id,s,m]);const de=o=>{d(o),console.log(`📊 Navigation vers l'onglet: ${o} pour mission ${s?.id}`)},oe=o=>{const r=parseFloat(o);return Array.from({length:5},(n,h)=>e.jsx(X,{className:`w-4 h-4 ${h<Math.floor(r)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"}`},h))};if(console.log("🔍 MissionDetailPage - État du rendu:",{isLoading:u,hasError:!!v,hasMission:!!s,missionId:s?.id}),u)return console.log("⏳ MissionDetailPage - Affichage du loading"),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Chargement de la mission"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Récupération des détails..."})]})]})})})});if(v||!s)return console.error("❌ MissionDetailPage - Erreur ou mission manquante:",{error:v instanceof Error?v.message:v,mission:s,missionId:x,hasError:!!v,hasMission:!!s,stack:v instanceof Error?v.stack:void 0}),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(os,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"Mission introuvable"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:v instanceof Error?v.message:"Cette mission n'existe plus ou a été supprimée."}),!1,e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(N,{onClick:()=>window.location.reload(),variant:"outline",children:"Recharger"}),e.jsxs(N,{onClick:()=>p("/marketplace"),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Retour au marketplace"]})]})]})})});console.log("✅ MissionDetailPage - Mission chargée, préparation du rendu:",s.title);const J=s?es(s.category):null,E=s?.bids?[...s.bids].sort((o,r)=>o.amount-r.amount):[],L=s?.teamRequirements&&s.teamRequirements.length>0;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(N,{onClick:()=>p("/marketplace"),variant:"ghost",className:"flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-800","data-testid":"button-back-marketplace",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Retour au marketplace"]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),E.length," candidature",E.length!==1?"s":""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"}),s.createdAt?ee(s.createdAt):"Date non spécifiée"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-3","data-testid":"text-mission-title",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1","data-testid":"text-client-name",children:[e.jsx(ie,{className:"w-4 h-4"}),s.clientName]}),e.jsxs("span",{className:"flex items-center gap-1","data-testid":"text-budget",children:[e.jsx(le,{className:"w-4 h-4"}),s.budgetDisplay]}),J&&e.jsx(_,{variant:"secondary",className:"text-xs","data-testid":"badge-category",children:J.name})]})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs(Ae,{value:g,onValueChange:de,className:"w-full",children:[e.jsxs(De,{className:"w-full bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-1 mb-6",children:[e.jsxs(O,{value:"overview",className:"flex-1 flex items-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 dark:data-[state=active]:bg-blue-900/30 dark:data-[state=active]:text-blue-400","data-testid":"tab-overview",children:[e.jsx(ms,{className:"w-4 h-4"}),"Détails"]}),e.jsxs(O,{value:"bids",className:"flex-1 flex items-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 dark:data-[state=active]:bg-blue-900/30 dark:data-[state=active]:text-blue-400","data-testid":"tab-bids",children:[e.jsx(us,{className:"w-4 h-4"}),"Offres",e.jsx(_,{variant:"secondary",className:"text-xs ml-1",children:E.length})]}),L&&e.jsxs(O,{value:"team",className:"flex-1 flex items-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 dark:data-[state=active]:bg-blue-900/30 dark:data-[state=active]:text-blue-400","data-testid":"tab-team",children:[e.jsx(B,{className:"w-4 h-4"}),"Équipe",e.jsx(_,{variant:"secondary",className:"text-xs ml-1",children:s.teamRequirements?.length||0})]})]}),e.jsxs(U,{value:"overview",className:"space-y-6","data-testid":"content-overview",children:[e.jsxs(y,{children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-blue-600"}),"Description du projet"]})}),e.jsx(w,{children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed","data-testid":"text-description",children:s.description})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Budget"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400","data-testid":"text-budget-amount",children:s.budgetDisplay})]})]})})}),e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(Pe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Localisation"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white","data-testid":"text-location",children:s.location||"Non spécifié"})]})]})})}),e.jsx(y,{children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Candidatures"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400","data-testid":"text-bids-count",children:E.length})]})]})})})]}),m&&m.type==="provider"&&s.clientName!==m.name&&e.jsx(gs,{mission:s,user:m,sortedBids:E,showAIAnalyzer:b,setShowAIAnalyzer:i,showBidForm:D,setShowBidForm:c}),m&&m.type==="provider"&&s.clientName===m.name&&e.jsx(y,{className:"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(we,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Ceci est votre mission"})]})})})]}),e.jsx(U,{value:"bids",className:"space-y-6","data-testid":"content-bids",children:E.length===0?e.jsx(y,{children:e.jsxs(w,{className:"p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(I,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Aucune candidature"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Cette mission n'a pas encore reçu d'offres de prestataires"})]})}):e.jsx("div",{className:"space-y-6",children:E.map((o,r)=>e.jsx(y,{className:"hover:shadow-md transition-all duration-200","data-testid":`card-bid-${o.id}`,children:e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:o.providerName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors",onClick:()=>{a(o.providerId),l(o.providerName)},"data-testid":`text-provider-${o.id}`,children:o.providerName}),r===0&&E.length>1&&e.jsx(_,{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:"Meilleure offre"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center",children:oe("5.0")}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"5.0/5"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mb-1","data-testid":`text-bid-amount-${o.id}`,children:o.price||ss(o.amount.toString())}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[e.jsx($e,{className:"w-4 h-4"}),o.timeline_days?`${o.timeline_days} jours`:"Non spécifié"]})]})]}),o.message&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed","data-testid":`text-bid-message-${o.id}`,children:o.message})}),m&&s.clientName===m.name&&e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs(N,{onClick:()=>{q(o.id),R(o.providerName)},variant:"outline",className:"flex items-center gap-2","data-testid":`button-contact-${o.id}`,children:[e.jsx(G,{className:"w-4 h-4"}),"Contacter"]}),e.jsxs(N,{className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2","data-testid":`button-accept-${o.id}`,children:[e.jsx(we,{className:"w-4 h-4"}),"Accepter l'offre"]})]})]})},o.id))})}),L&&e.jsx(U,{value:"team",className:"space-y-6","data-testid":"content-team",children:e.jsxs(y,{children:[e.jsx(z,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-purple-600"}),"Exigences d'équipe"]})}),e.jsx(w,{children:e.jsx("div",{className:"space-y-4",children:s.teamRequirements?.map((o,r)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:o.profession}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3",children:o.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[o.estimated_budget,"€"]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[o.min_experience," ans d'expérience"]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[o.estimated_days," jours"]})]})]},r))})})]})})]})}),e.jsx(js,{providerId:f,providerName:t,isOpen:!!f,onClose:()=>{a(null),l("")}}),e.jsx(vs,{bidId:j,bidderName:M,isOpen:!!j,onClose:()=>{q(null),R("")}}),D&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(Ee,{missionId:x,onSuccess:()=>{c(!1),window.location.reload()}})})}),b&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Analyse IA de la mission"}),e.jsx(N,{onClick:()=>i(!1),variant:"ghost",size:"sm",children:"✕"})]}),e.jsx(Fe,{missionTitle:s.title,missionDescription:s.description,missionBudget:s.budget_value_cents||0,missionCategory:s.category,currentBid:{price:0,timeline:"À définir",proposal:""},providerProfile:{rating:5,completedProjects:0,expertise:[]},onRecommendationApplied:()=>{i(!1),c(!0)}})]})})})]})}export{tt as default};
