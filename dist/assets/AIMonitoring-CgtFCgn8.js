import{r as m,j as e}from"./ui-BcXBiFQq.js";import{B as o,C as c,a as r,h as i,b as l,q as h,x,A as j,Z as T,s as F}from"./index-BGXeoACk.js";import{B as A}from"./badge-DdnoGfkE.js";import{T as S,a as q,b as u,c as p}from"./tabs-8Yaac2kj.js";import{T as N}from"./triangle-alert-PgigWzHA.js";import{C as f}from"./circle-x-j-P3FM_y.js";import{A as y}from"./activity-B89Es-3i.js";import{S as I}from"./shield-BV7iBniL.js";import{T as L}from"./trending-up-BvZYh_pU.js";import"./vendor-D3F3s8fL.js";const v={"neural-pricing":e.jsx(F,{className:"h-4 w-4"}),"semantic-matching":e.jsx(T,{className:"h-4 w-4"}),"predictive-analytics":e.jsx(L,{className:"h-4 w-4"}),"fraud-detection":e.jsx(I,{className:"h-4 w-4"}),"trust-scoring":e.jsx(h,{className:"h-4 w-4"})},M=a=>{switch(a){case"healthy":return"bg-green-500";case"degraded":return"bg-yellow-500";case"critical":return"bg-red-500";default:return"bg-gray-500"}},R=a=>{switch(a){case"healthy":return e.jsx(h,{className:"h-4 w-4 text-green-600"});case"degraded":return e.jsx(N,{className:"h-4 w-4 text-yellow-600"});case"critical":return e.jsx(f,{className:"h-4 w-4 text-red-600"});default:return e.jsx(y,{className:"h-4 w-4 text-gray-600"})}};function V(){const[a,g]=m.useState(null),[_,b]=m.useState(!0),[d,w]=m.useState(!0),n=async()=>{try{const s=await fetch("/api/ai/metrics");if(s.ok){const t=await s.json();g(t)}}catch(s){console.error("Erreur lors du chargement des métriques:",s)}finally{b(!1)}},C=async()=>{try{const s=await fetch("/api/ai/optimize",{method:"POST"});if(s.ok){const t=await s.json();console.log("Optimisations appliquées:",t),n()}}catch(s){console.error("Erreur lors de l'optimisation:",s)}};return m.useEffect(()=>{if(n(),d){const s=setInterval(n,5e3);return()=>clearInterval(s)}},[d]),_?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a?e.jsxs("div",{className:"container mx-auto p-6 space-y-6","data-testid":"ai-monitoring-page",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Monitoring IA"}),e.jsx("p",{className:"text-gray-600",children:"Surveillance des performances des algorithmes AppelsPro"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:d?"default":"outline",onClick:()=>w(!d),"data-testid":"button-toggle-refresh",children:d?"Auto":"Manuel"}),e.jsx(o,{onClick:C,"data-testid":"button-optimize",children:"Optimiser"}),e.jsx(o,{onClick:n,variant:"outline","data-testid":"button-refresh",children:"Actualiser"})]})]}),a.alerts.length>0&&e.jsxs(c,{className:"border-red-200 bg-red-50",children:[e.jsx(r,{children:e.jsxs(i,{className:"text-red-800 flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Alertes Système (",a.alerts.length,")"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-2",children:a.alerts.map((s,t)=>e.jsxs("div",{className:"text-red-700 text-sm","data-testid":`alert-${t}`,children:["• ",s]},t))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(c,{children:[e.jsx(r,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Requêtes Totales"})}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-requests",children:a.system.total_ai_requests.toLocaleString()})})]}),e.jsxs(c,{children:[e.jsx(r,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Latence Moyenne"})}),e.jsx(l,{children:e.jsxs("div",{className:"text-2xl font-bold","data-testid":"text-avg-latency",children:[a.system.avg_system_latency.toFixed(1),"ms"]})})]}),e.jsxs(c,{children:[e.jsx(r,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Efficacité Cache"})}),e.jsx(l,{children:e.jsxs("div",{className:"text-2xl font-bold","data-testid":"text-cache-efficiency",children:[a.system.cache_efficiency.toFixed(1),"%"]})})]}),e.jsxs(c,{children:[e.jsx(r,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium",children:"Service ML"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.system.ml_service_status?e.jsx(h,{className:"h-5 w-5 text-green-600"}):e.jsx(f,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"font-semibold","data-testid":"text-ml-status",children:a.system.ml_service_status?"En ligne":"Hors ligne"})]})})]})]}),e.jsxs(S,{defaultValue:"overview",className:"w-full",children:[e.jsxs(q,{className:"grid w-full grid-cols-3",children:[e.jsx(u,{value:"overview",children:"Vue d'ensemble"}),e.jsx(u,{value:"engines",children:"Moteurs IA"}),e.jsx(u,{value:"performance",children:"Performance"})]}),e.jsx(p,{value:"overview",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.engines.map(s=>e.jsxs(c,{"data-testid":`card-engine-${s.engine_name}`,children:[e.jsxs(r,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v[s.engine_name]||e.jsx(y,{className:"h-4 w-4"}),e.jsx(i,{className:"text-sm",children:s.engine_name.replace("-"," ").replace(/\b\w/g,t=>t.toUpperCase())})]}),R(s.status)]}),e.jsx("div",{className:`h-2 rounded-full ${M(s.status)}`})]}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Requêtes"}),e.jsx("div",{className:"font-semibold","data-testid":`text-requests-${s.engine_name}`,children:s.total_requests.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Latence"}),e.jsxs("div",{className:"font-semibold","data-testid":`text-latency-${s.engine_name}`,children:[s.avg_response_time_ms.toFixed(1),"ms"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Précision"}),e.jsxs("div",{className:"font-semibold","data-testid":`text-accuracy-${s.engine_name}`,children:[s.accuracy_score.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Cache"}),e.jsxs("div",{className:"font-semibold","data-testid":`text-cache-${s.engine_name}`,children:[s.cache_hit_rate.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Taux de succès"}),e.jsxs("span",{children:[s.success_rate.toFixed(1),"%"]})]}),e.jsx(x,{value:s.success_rate,className:"h-1"})]})]})]},s.engine_name))})}),e.jsx(p,{value:"engines",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:a.engines.map(s=>e.jsxs(c,{children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v[s.engine_name],e.jsxs("div",{children:[e.jsx(i,{children:s.engine_name.replace("-"," ").replace(/\b\w/g,t=>t.toUpperCase())}),e.jsxs(j,{children:["Dernière mise à jour: ",new Date(s.last_update).toLocaleTimeString()]})]})]}),e.jsx(A,{variant:s.status==="healthy"?"default":"destructive",children:s.status})]})}),e.jsxs(l,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.total_requests.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"Requêtes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[s.avg_response_time_ms.toFixed(1),"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Temps de réponse"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[s.accuracy_score.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Précision"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[s.cache_hit_rate.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Cache"})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Taux de succès"}),e.jsxs("span",{className:"font-semibold",children:[s.success_rate.toFixed(1),"%"]})]}),e.jsx(x,{value:s.success_rate,className:"h-2"})]})]})]},s.engine_name))})}),e.jsx(p,{value:"performance",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsxs(r,{children:[e.jsx(i,{children:"Performance Système"}),e.jsx(j,{children:"Métriques globales de performance IA"})]}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Latence moyenne système"}),e.jsxs("span",{className:"font-semibold",children:[a.system.avg_system_latency.toFixed(1),"ms"]})]}),e.jsx(x,{value:Math.max(0,100-a.system.avg_system_latency),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Efficacité cache global"}),e.jsxs("span",{className:"font-semibold",children:[a.system.cache_efficiency.toFixed(1),"%"]})]}),e.jsx(x,{value:a.system.cache_efficiency,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Taux d'erreur"}),e.jsxs("span",{className:"font-semibold text-red-600",children:[a.system.error_rate.toFixed(1),"%"]})]}),e.jsx(x,{value:Math.max(0,100-a.system.error_rate),className:"h-2"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"text-sm text-gray-600",children:["Uptime: ",a.system.uptime_hours.toFixed(1)," heures"]})})]})]}),e.jsxs(c,{children:[e.jsxs(r,{children:[e.jsx(i,{children:"Optimisations Recommandées"}),e.jsx(j,{children:"Actions pour améliorer les performances"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-3",children:[a.engines.filter(s=>s.cache_hit_rate<60||s.avg_response_time_ms>100||s.accuracy_score<85).map(s=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"font-semibold text-sm mb-1",children:s.engine_name.replace("-"," ").replace(/\b\w/g,t=>t.toUpperCase())}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[s.cache_hit_rate<60&&e.jsxs("div",{children:["• Améliorer la stratégie de cache (",s.cache_hit_rate.toFixed(1),"%)"]}),s.avg_response_time_ms>100&&e.jsxs("div",{children:["• Optimiser la latence (",s.avg_response_time_ms.toFixed(1),"ms)"]}),s.accuracy_score<85&&e.jsxs("div",{children:["• Recalibrer le modèle (",s.accuracy_score.toFixed(1),"%)"]})]})]},s.engine_name)),a.engines.every(s=>s.cache_hit_rate>=60&&s.avg_response_time_ms<=100&&s.accuracy_score>=85)&&e.jsxs("div",{className:"text-center py-4 text-green-600",children:[e.jsx(h,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("div",{className:"font-semibold",children:"Toutes les performances sont optimales"})]})]})})]})]})})]})]}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-500",children:"Impossible de charger les métriques IA"}),e.jsx(o,{onClick:n,className:"mt-4",children:"Réessayer"})]})}export{V as default};
