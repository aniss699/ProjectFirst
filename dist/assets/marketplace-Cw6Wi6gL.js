import{j as e,r as M}from"./ui-he1BrmUV.js";import{u as re}from"./useQuery-ofNtNMRZ.js";import{C as F,b as Q,c as W,U as G,d as ne,e as le,f as ie,Z as ce,P as oe,T as de,B as $,g as me,u as ue,L as U,I as xe}from"./index-DsLkkl8O.js";import{d as he}from"./services-B9yTTPPJ.js";import{B}from"./badge-SwzJIJ2h.js";import{c as J}from"./categories-CJOmrs8V.js";import{E as ge}from"./euro-DRPWqfrL.js";import{M as fe}from"./map-pin-CcCz7NAX.js";import{T as ee}from"./trending-up-Bhsm596X.js";import{C as pe}from"./clock-0l0HYlnj.js";import{t as y,c as be,e as je,d as ye,g as Y,a as Ne,b as ve,m as Z,f as z}from"./en-US-oEpl4HuW.js";import{f as we}from"./fr-Qfl_UVRO.js";import{R as Me}from"./refresh-cw-Bxo_PB7t.js";import{T as Ce,C as Se}from"./triangle-alert-Bo0ruc-3.js";import{S as X,a as O,b as V,c as K,d as w}from"./select-BZRs8HYG.js";import{B as De}from"./brain-BRw3irpP.js";import{S as Le}from"./star-VEV52_l0.js";import"./vendor-D3F3s8fL.js";import"./index-BelvN6Su.js";import"./chevron-up-CKhPFHle.js";function _(a,o){const m=y(a),u=y(o),c=m.getTime()-u.getTime();return c<0?-1:c>0?1:c}function Re(a){return be(a,Date.now())}function Te(a){return o=>{const u=(a?Math[a]:Math.trunc)(o);return u===0?0:u}}function ke(a,o){return+y(a)-+y(o)}function Pe(a){const o=y(a);return o.setHours(23,59,59,999),o}function Ie(a){const o=y(a);return+Pe(o)==+je(o)}function Ae(a,o){const m=y(a),u=y(o),c=_(m,u),j=Math.abs(ye(m,u));let b;if(j<1)b=0;else{m.getMonth()===1&&m.getDate()>27&&m.setDate(30),m.setMonth(m.getMonth()-c*j);let d=_(m,u)===-c;Ie(y(a))&&j===1&&_(a,u)===1&&(d=!1),b=c*(j-Number(d))}return b===0?0:b}function Be(a,o,m){const u=ke(a,o)/1e3;return Te(m?.roundingMethod)(u)}function Ee(a,o,m){const u=Ne(),c=m?.locale??u.locale??ve,j=2520,b=_(a,o);if(isNaN(b))throw new RangeError("Invalid time value");const d=Object.assign({},m,{addSuffix:m?.addSuffix,comparison:b});let N,S;b>0?(N=y(o),S=y(a)):(N=y(a),S=y(o));const h=Be(S,N),k=(Y(S)-Y(N))/1e3,p=Math.round((h-k)/60);let g;if(p<2)return m?.includeSeconds?h<5?c.formatDistance("lessThanXSeconds",5,d):h<10?c.formatDistance("lessThanXSeconds",10,d):h<20?c.formatDistance("lessThanXSeconds",20,d):h<40?c.formatDistance("halfAMinute",0,d):h<60?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",1,d):p===0?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",p,d);if(p<45)return c.formatDistance("xMinutes",p,d);if(p<90)return c.formatDistance("aboutXHours",1,d);if(p<Z){const f=Math.round(p/60);return c.formatDistance("aboutXHours",f,d)}else{if(p<j)return c.formatDistance("xDays",1,d);if(p<z){const f=Math.round(p/Z);return c.formatDistance("xDays",f,d)}else if(p<z*2)return g=Math.round(p/z),c.formatDistance("aboutXMonths",g,d)}if(g=Ae(S,N),g<12){const f=Math.round(p/z);return c.formatDistance("xMonths",f,d)}else{const f=g%12,C=Math.trunc(g/12);return f<3?c.formatDistance("aboutXYears",C,d):f<9?c.formatDistance("overXYears",C,d):c.formatDistance("almostXYears",C+1,d)}}function ze(a,o){return Ee(a,Re(a),o)}function Fe({mission:a,onClick:o}){const m=J.find(c=>c.id===a.category),u=a.bids.length>0?a.bids.reduce((c,j)=>c+j.amount,0)/a.bids.length:0;return e.jsxs(F,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-l-4 border-l-blue-500 hover:scale-[1.02] bg-white h-fit",onClick:o,children:[e.jsx(Q,{className:"pb-2 pt-3",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h3",{className:"font-semibold text-base line-clamp-2 flex-1 leading-tight",children:a.title}),e.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[e.jsx(B,{variant:"secondary",className:"shrink-0 text-xs px-2 py-1",children:m?.name||a.category}),a.bids.length>0&&e.jsxs(B,{variant:"outline",className:"text-xs px-2 py-1",children:["🔥 ",a.bids.length]})]})]})}),e.jsxs(W,{className:"py-1",children:[e.jsx("p",{className:"text-gray-600 line-clamp-2 mb-3 text-sm leading-relaxed",children:a.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ge,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"font-medium truncate",children:a.budgetDisplay})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(G,{className:"w-3 h-3 text-purple-600"}),e.jsxs("span",{className:"truncate",children:[a.bids.length," offre",a.bids.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(fe,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"truncate",children:a.location||"Non spécifié"})]}),u>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ee,{className:"w-3 h-3 text-orange-600"}),e.jsxs("span",{className:"font-medium truncate",children:[Math.round(u),"€ moy"]})]})]})]}),e.jsx(ne,{className:"pt-2 pb-3 border-t bg-gray-50/50",children:e.jsxs("div",{className:"flex justify-between items-center w-full text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:ze(new Date(a.createdAt),{addSuffix:!0,locale:we})})]}),e.jsx("div",{className:"text-xs font-medium text-primary truncate ml-2",children:a.clientName})]})})]})}function $e({isLoading:a=!1,hasError:o=!1,isFallbackMode:m=!1,errorMessage:u,onRetry:c,className:j=""}){if(!a&&!o&&!m)return null;const d=a?{icon:Me,color:"blue",title:"Chargement en cours...",message:"Récupération des données",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-800",iconClass:"text-blue-500 animate-spin"}:m?{icon:Ce,color:"orange",title:"Mode dégradé",message:"Le service fonctionne avec des fonctionnalités limitées",bgClass:"bg-orange-50 border-orange-200",textClass:"text-orange-800",iconClass:"text-orange-500"}:o?{icon:Se,color:"red",title:"Problème technique",message:u||"Une erreur est survenue",bgClass:"bg-red-50 border-red-200",textClass:"text-red-800",iconClass:"text-red-500"}:{icon:le,color:"green",title:"Service opérationnel",message:"Tout fonctionne normalement",bgClass:"bg-green-50 border-green-200",textClass:"text-green-800",iconClass:"text-green-500"},N=d.icon;return e.jsx("div",{className:`border rounded-lg p-4 ${d.bgClass} ${j}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:`w-5 h-5 ${d.iconClass}`}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${d.textClass}`,children:d.title}),e.jsx("p",{className:`text-sm ${d.textClass} opacity-80`,children:d.message})]})]}),c&&(o||m)&&e.jsx("button",{onClick:c,className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${d.color==="orange"?"bg-orange-200 hover:bg-orange-300 text-orange-800":"bg-red-200 hover:bg-red-300 text-red-800"}`,children:"Réessayer"})]})})}function _e({providerProfile:a,missions:o,onMissionRecommended:m}){const[u,c]=M.useState([]),[j,b]=M.useState(!1),[d,N]=M.useState({minMatchScore:70,maxCompetition:"high",minWinProbability:40}),S=async()=>{b(!0),await new Promise(t=>setTimeout(t,1500));const i=o.map(t=>{const r=h(t,a),l=k(t,a),A=p(t,a),T=g(t,a),q=r*.35+l*.25+A*.15+T*.25,R=f(t),H=C(q,R,a.rating,a.completedProjects),te=L(t,R,a),se=D(t),ae=v(t,a,{skillsMatch:r,locationMatch:A,competitionLevel:R,winProbability:H});return{missionId:t.id,title:t.title,description:t.description,budget:t.budget,matchScore:q,reasonsToApply:ae,competitionLevel:R,winProbability:H,recommendedBidPrice:te,skillsMatch:r,experienceMatch:l,locationMatch:A,urgency:se,clientProfile:{name:t.clientName,rating:4.2+Math.random()*.8,projectsPosted:Math.floor(Math.random()*20)+1,avgBudget:t.budget*(.8+Math.random()*.4)}}}).sort((t,r)=>r.matchScore-t.matchScore).slice(0,10);c(i),b(!1)},h=(s,i)=>{const t=P(s),r=i.skills.map(T=>T.toLowerCase());let l=0,A=t.length;return t.forEach(T=>{r.some(R=>R.includes(T)||T.includes(R)||I(T,R)>.7)&&l++}),Math.min(100,l/Math.max(A,1)*100)},k=(s,i)=>{let t=0;return i.completedProjects>=50?t+=40:i.completedProjects>=20?t+=30:i.completedProjects>=5?t+=20:t+=10,i.categories.includes(s.category)&&(t+=30),t+=i.rating/5*30,Math.min(100,t)},p=(s,i)=>{if(!s.location||!i.location)return 70;const t=s.location.toLowerCase(),r=i.location.toLowerCase();if(t===r)return 100;if(t.includes(r)||r.includes(t))return 85;const l=Math.random()*500;return l<50?90:l<100?75:l<200?60:40},g=(s,i)=>{const t=s.budget,r=i.hourlyRate,l=t/r;return l>=20&&l<=100?100:l>=10&&l<=150?80:l>=5&&l<=200?60:40},f=s=>{const i=s.bids?.length||0,t=Math.floor((Date.now()-new Date(s.createdAt).getTime())/(1e3*60*60*24));return i>10||t>7?"high":i>5||t>3?"medium":"low"},C=(s,i,t,r)=>{let l=s;return i==="low"?l*=1.3:i==="high"&&(l*=.7),l+=t/5*10,l+=Math.min(15,r*.2),Math.min(95,Math.max(5,l))},L=(s,i,t)=>{let l=s.budget;return i==="high"?l*=.85:i==="low"?l*=.95:l*=.9,t.rating>=4.5&&t.completedMissions>=20&&(l*=1.05),Math.round(l)},D=s=>{if(["urgent","asap","rapidement","immédiat","express"].some(l=>s.title.toLowerCase().includes(l)||s.description.toLowerCase().includes(l)))return"high";const r=Math.floor((Date.now()-new Date(s.createdAt).getTime())/(1e3*60*60*24));return r<=1?"high":r<=3?"medium":"low"},v=(s,i,t)=>{const r=[];return t.skillsMatch>=80&&r.push("Parfaite correspondance avec vos compétences"),t.competitionLevel==="low"&&r.push("Faible concurrence - grande chance de succès"),t.winProbability>=70&&r.push(`${Math.round(t.winProbability)}% de probabilité de gagner`),s.budget>=i.hourlyRate*20&&r.push("Budget attractif pour ce type de projet"),t.locationMatch>=90&&r.push("Client dans votre zone géographique"),r.slice(0,3)},P=s=>{const i=(s.title+" "+s.description+" "+s.category).toLowerCase(),t=["le","la","les","un","une","des","et","ou","mais","donc"];return i.split(/[\s,;.!?]+/).filter(r=>r.length>3&&!t.includes(r)).slice(0,10)},I=(s,i)=>{const t=s.length>i.length?s:i,r=s.length>i.length?i:s;if(t.length===0)return 1;const l=n(t,r);return(t.length-l)/t.length},n=(s,i)=>{const t=[];for(let r=0;r<=i.length;r++)t[r]=[r];for(let r=0;r<=s.length;r++)t[0][r]=r;for(let r=1;r<=i.length;r++)for(let l=1;l<=s.length;l++)i.charAt(r-1)===s.charAt(l-1)?t[r][l]=t[r-1][l-1]:t[r][l]=Math.min(t[r-1][l-1]+1,t[r][l-1]+1,t[r-1][l]+1);return t[i.length][s.length]},x=s=>{switch(s){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},E=s=>{switch(s){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return M.useEffect(()=>{o.length>0&&S()},[o,a]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(F,{children:e.jsx(Q,{children:e.jsxs(ie,{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-6 h-6 text-purple-600"}),e.jsx("span",{children:"Moteur de Matching IA"}),e.jsxs(B,{variant:"secondary",className:"bg-purple-100 text-purple-700",children:[e.jsx(ce,{className:"w-3 h-3 mr-1"}),"Algorithm v2.0"]})]})})}),j?e.jsx(F,{children:e.jsxs(W,{className:"py-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-600",children:["Analyse de ",o.length," missions avec notre IA..."]})]})}):e.jsx("div",{className:"space-y-4",children:u.map((s,i)=>e.jsx(F,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(W,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.title}),e.jsxs(B,{className:`px-2 py-1 text-xs ${x(s.competitionLevel)}`,children:["Concurrence ",s.competitionLevel]}),e.jsx(B,{className:`px-2 py-1 text-xs ${E(s.urgency)}`,children:s.urgency==="high"?"Urgent":s.urgency==="medium"?"Normal":"Pas pressé"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[s.budget,"€"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Prix suggéré: ",s.recommendedBidPrice,"€"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Score de correspondance"}),e.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[Math.round(s.matchScore),"%"]})]}),e.jsx(oe,{value:s.matchScore,className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-gray-600",children:[e.jsxs("div",{children:["Compétences: ",Math.round(s.skillsMatch),"%"]}),e.jsxs("div",{children:["Expérience: ",Math.round(s.experienceMatch),"%"]}),e.jsxs("div",{children:["Localisation: ",Math.round(s.locationMatch),"%"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(de,{className:"w-4 h-4 mr-1 text-blue-600"}),"Pourquoi postuler"]}),e.jsx("ul",{className:"space-y-1",children:s.reasonsToApply.map((t,r)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"•"}),t]},r))})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),s.clientProfile.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 mr-1 text-yellow-500"}),s.clientProfile.rating.toFixed(1)]}),e.jsxs("div",{children:[s.clientProfile.projectsPosted," projets postés"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.winProbability),"% de succès"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Rang #",i+1," sur ",u.length]}),e.jsx($,{onClick:()=>m?.(s),className:"bg-purple-600 hover:bg-purple-700",children:"Voir la mission"})]})]})},s.missionId))})]})}function it(){const{user:a}=me(),[,o]=ue(),[m,u]=M.useState(!1),[c,j]=M.useState(!1),[b,d]=M.useState(0),[N,S]=M.useState(0),[h,k]=M.useState({category:"all",budget:"all",location:"",sort:"newest"}),{data:p,isLoading:g,error:f,refetch:C}=re({queryKey:["/api/missions"],queryFn:async()=>{console.log("🔄 Début requête missions API avec mappers...");try{const n=await he.getMissions();return console.log("✅ Missions normalisées récupérées:",n.missions.length),n}catch(n){return console.error("❌ Erreur réseau:",n),{missions:[],metadata:{total:0,has_errors:!0,error_message:`Erreur réseau: ${n instanceof Error?n.message:"Unknown error"}`,fallback_mode:!0}}}},refetchInterval:12e4,retry:(n,x)=>(console.log(`🔄 Tentative ${n+1}/3 après erreur:`,x),n<2),retryDelay:n=>{const x=Math.min(1e3*Math.pow(2,n),1e4);return console.log(`⏳ Retry dans ${x}ms`),x},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,meta:{errorPolicy:"soft"}}),L=p?.missions||[],D=p?.metadata||{total:0},v=D.fallback_mode||!1;console.log("🏪 Marketplace - État actuel:",{missionsCount:L.length,isLoading:g,hasError:!!f,errorMessage:f?.message}),M.useEffect(()=>{if(f&&!g&&b<3&&Date.now()-N>5e3){const s=Math.min(2e3*Math.pow(2,b),1e4);console.log(`🔄 Retry automatique #${b+1} dans ${s}ms`);const i=setTimeout(()=>{console.log(`🔄 Exécution retry automatique #${b+1}`),d(t=>t+1),S(Date.now()),C()},s);return()=>clearTimeout(i)}},[f,g,b,N,C]),M.useEffect(()=>{!f&&!g&&L.length>0&&d(0)},[f,g,L.length]);const P=L.filter(n=>{if(h.category&&h.category!=="all"&&n.category!==h.category||h.location&&!n.location?.toLowerCase().includes(h.location.toLowerCase()))return!1;if(h.budget&&h.budget!=="all"){const x=n.budget;switch(h.budget){case"0-500":return x>=0&&x<=500;case"500-2000":return x>500&&x<=2e3;case"2000-5000":return x>2e3&&x<=5e3;case"5000+":return x>5e3;default:return!0}}return!0}).sort((n,x)=>{switch(h.sort){case"newest":return new Date(x.createdAt).getTime()-new Date(n.createdAt).getTime();case"budget-high":return x.budget-n.budget;case"budget-low":return n.budget-x.budget;case"bids":return x.bids.length-n.bids.length;default:return 0}}),I=(n,x)=>{k(E=>({...E,[n]:x}))};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 sm:mb-4",children:"Marketplace des Projets"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 mb-4",children:"Découvrez et soumissionnez sur les projets disponibles"}),e.jsx($e,{isLoading:g,hasError:!!f&&!v,isFallbackMode:v,errorMessage:D?.error_message,onRetry:()=>{console.log("🔄 Retry depuis la bannière"),C()},className:"mb-4"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs($,{onClick:()=>j(!c),variant:"outline",className:"mb-4 gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),"Filtres",c?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),c&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Filtres de recherche"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(U,{htmlFor:"category-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Catégorie"}),e.jsxs(X,{value:h.category,onValueChange:n=>I("category",n),children:[e.jsx(O,{className:"h-8",children:e.jsx(V,{placeholder:"Toutes les catégories"})}),e.jsxs(K,{children:[e.jsx(w,{value:"all",children:"Toutes les catégories"}),J.map(n=>e.jsx(w,{value:n.id,children:n.name},n.id))]})]})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"budget-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Budget"}),e.jsxs(X,{value:h.budget,onValueChange:n=>I("budget",n),children:[e.jsx(O,{className:"h-8",children:e.jsx(V,{placeholder:"Tous les budgets"})}),e.jsxs(K,{children:[e.jsx(w,{value:"all",children:"Tous les budgets"}),e.jsx(w,{value:"0-500",children:"0 - 500€"}),e.jsx(w,{value:"500-2000",children:"500€ - 2 000€"}),e.jsx(w,{value:"2000-5000",children:"2 000€ - 5 000€"}),e.jsx(w,{value:"5000+",children:"5 000€+"})]})]})]}),e.jsxs("div",{children:[e.jsx(U,{htmlFor:"location-filter",className:"text-xs font-medium text-gray-600 mb-1 block",children:"Localisation"}),e.jsx(xe,{id:"location-filter",type:"text",placeholder:"Ville, région...",value:h.location,onChange:n=>I("location",n.target.value),className:"h-8"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx($,{onClick:()=>k({category:"all",budget:"all",location:"",sort:"newest"}),variant:"outline",className:"h-8 w-full",size:"sm",children:"Réinitialiser"})})]})]})]}),e.jsxs("div",{className:"lg:w-3/4 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-4 sm:mb-0",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Toutes les missions (",P.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Chargement..."]}),!g&&!f&&!v&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Service actif"]}),v&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"Mode dégradé"]}),D?.total!==void 0&&e.jsxs("div",{className:"text-sm text-gray-500",children:[D.total," total",D.has_errors&&" (avec erreurs)"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[a?.type==="provider"&&e.jsx($,{onClick:()=>u(!m),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 w-full sm:w-auto",children:"🤖 Matching IA"}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"Trier par:"}),e.jsxs(X,{value:h.sort,onValueChange:n=>I("sort",n),children:[e.jsx(O,{className:"w-full sm:w-40",children:e.jsx(V,{})}),e.jsxs(K,{children:[e.jsx(w,{value:"newest",children:"Plus récent"}),e.jsx(w,{value:"budget-high",children:"Budget décroissant"}),e.jsx(w,{value:"budget-low",children:"Budget croissant"}),e.jsx(w,{value:"bids",children:"Nombre d'offres"})]})]})]})]})]}),m&&a?.type==="provider"&&e.jsx("div",{className:"mb-8",children:e.jsx(_e,{providerProfile:{id:a.id,skills:["React","Node.js","TypeScript","Python"],location:"Paris",rating:4.7,completedProjects:28,portfolio:[],hourlyRate:65,categories:["web-development","mobile-development"]},missions:P,onMissionRecommended:n=>{o(`/missions/${n.missionId}`),u(!1)}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[g&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Chargement des missions..."})]}),(f||v)&&!g&&e.jsx("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-2xl p-8 mx-auto max-w-2xl",children:[e.jsx("div",{className:"text-orange-500 mb-4",children:v?"⚠️":"❌"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:v?"Mode dégradé activé":"Problème de chargement"}),e.jsx("p",{className:"text-gray-700 text-base mb-4",children:v?"Les missions ne peuvent pas être chargées normalement. Le système fonctionne en mode dégradé.":"Impossible de charger les missions pour le moment."}),D.error_message&&e.jsxs("div",{className:"bg-white/70 rounded-lg p-4 mb-4 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Détail:"})," ",D.error_message]}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-6",children:[e.jsx("button",{onClick:()=>{console.log("🔄 Retry manuel déclenché"),C()},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"🔄 Réessayer"}),e.jsx("button",{onClick:()=>{console.log("🏠 Retour accueil"),window.location.href="/"},className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"🏠 Retour accueil"})]}),e.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[e.jsxs("p",{className:"mb-2",children:["💡 ",e.jsx("strong",{children:"Suggestions:"})]}),e.jsxs("ul",{className:"text-left space-y-1 max-w-md mx-auto",children:[e.jsx("li",{children:"• Vérifiez votre connexion internet"}),e.jsx("li",{children:"• Essayez de recharger dans quelques minutes"}),e.jsx("li",{children:"• Contactez le support si le problème persiste"})]})]})]})}),v&&!g&&L.length===0&&e.jsx("div",{className:"sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6 mb-8",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"🎯 Missions de démonstration"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"En attendant le retour du service, voici quelques exemples de missions typiques :"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"demo-1",title:"Développement site e-commerce",description:"Création d'un site e-commerce moderne avec React et Node.js",category:"developpement",budget:"3500",location:"Remote",status:"open",createdAt:new Date().toISOString(),bids:[]},{id:"demo-2",title:"Design d'application mobile",description:"Design UI/UX pour une application de fitness",category:"design",budget:"2200",location:"Paris",status:"open",createdAt:new Date().toISOString(),bids:[]}].map((n,x)=>e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-blue-100",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:n.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:n.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:[n.budget,"€"]}),e.jsx("span",{className:"text-gray-500",children:n.location})]})]},x))})]})}),!g&&!f&&P.map(n=>e.jsx(Fe,{mission:n,onClick:()=>o(`/missions/${n.id}`)},n.id)),!g&&!f&&P.length===0&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-gray-300 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L10 8.586 8.707 7.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("p",{className:"text-gray-500 text-lg",children:["Aucune mission trouvée (",L.length," missions totales)"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Essayez de modifier vos filtres"})]})]})]})]})}export{it as default};
