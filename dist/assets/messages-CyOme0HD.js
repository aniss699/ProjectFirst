import{r as x,j as e}from"./ui-BcXBiFQq.js";import{d as z,C as m,b as o,a as f,h as q,z as A,I as v,B as n,M as P}from"./index-BGXeoACk.js";import{A as b,a as w,b as y}from"./avatar-CVU0RRVM.js";import{B as M}from"./badge-DdnoGfkE.js";import{P as $}from"./phone-BBMuWyf5.js";import{V as B,E,P as O,S as R}from"./video-CjCsE7XZ.js";import{S as k}from"./send-wEwkLOZn.js";import"./vendor-D3F3s8fL.js";function U(){const{user:a}=z(),[l,C]=x.useState(null),[c,h]=x.useState(""),[D,T]=x.useState(""),i=[{id:"1",participantId:"1",participantName:"Marie Dubois",lastMessage:"Parfait, quand pouvons-nous commencer ?",lastMessageTime:new Date(Date.now()-1800*1e3),unreadCount:2,isOnline:!0,missionTitle:"Site web e-commerce"},{id:"2",participantId:"2",participantName:"Jean Martin",lastMessage:"J'ai quelques questions sur le projet",lastMessageTime:new Date(Date.now()-7200*1e3),unreadCount:0,isOnline:!1,missionTitle:"Application mobile"},{id:"3",participantId:"3",participantName:"Sophie Laurent",lastMessage:"Merci pour votre proposition",lastMessageTime:new Date(Date.now()-1440*60*1e3),unreadCount:1,isOnline:!0,missionTitle:"Logo et identité visuelle"}],u=[{id:"1",senderId:"1",senderName:"Marie Dubois",content:"Bonjour, j'ai vu votre candidature pour mon projet de site e-commerce.",timestamp:new Date(Date.now()-3600*1e3),isRead:!0},{id:"2",senderId:a?.id||"",senderName:a?.name||"",content:"Bonjour Marie ! Merci pour votre message. Je serais ravi de discuter de votre projet.",timestamp:new Date(Date.now()-2700*1e3),isRead:!0},{id:"3",senderId:"1",senderName:"Marie Dubois",content:"Parfait, quand pouvons-nous commencer ?",timestamp:new Date(Date.now()-1800*1e3),isRead:!1}],t=i.find(s=>s.id===l),S=l?u:[],p=()=>{if(c.trim()&&l){const s={id:Date.now().toString(),senderId:a?.id||"",senderName:a?.name||"",content:c.trim(),timestamp:new Date,isRead:!0};u.push(s);const r=i.findIndex(d=>d.id===l);r!==-1&&(i[r].lastMessage=c.trim(),i[r].lastMessageTime=new Date),h("")}},j=s=>{const d=new Date().getTime()-s.getTime(),g=Math.floor(d/6e4),N=Math.floor(d/36e5),I=Math.floor(d/864e5);return g<60?`${g}min`:N<24?`${N}h`:`${I}j`};return a?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Messages"}),e.jsx("p",{className:"text-gray-600",children:"Communiquez avec vos clients et prestataires"})]}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-6 h-[calc(100vh-12rem)]",children:[e.jsx("div",{className:"lg:col-span-4",children:e.jsxs(m,{className:"h-full",children:[e.jsxs(f,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(q,{className:"text-lg",children:"Conversations"}),e.jsx(M,{variant:"secondary",children:i.length})]}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(v,{placeholder:"Rechercher une conversation...",value:D,onChange:s=>T(s.target.value),className:"pl-10"})]})]}),e.jsx(o,{className:"p-0",children:e.jsx("div",{className:"space-y-1",children:i.map(s=>e.jsx("div",{onClick:()=>C(s.id),className:`p-4 cursor-pointer hover:bg-gray-50 border-l-4 transition-all ${l===s.id?"bg-blue-50 border-l-blue-500":"border-l-transparent"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(b,{className:"w-10 h-10",children:[e.jsx(w,{src:s.participantAvatar}),e.jsx(y,{children:s.participantName.split(" ").map(r=>r[0]).join("")})]}),s.isOnline&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:s.participantName}),e.jsx("span",{className:"text-xs text-gray-500",children:j(s.lastMessageTime)})]}),s.missionTitle&&e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:s.missionTitle}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.lastMessage}),s.unreadCount>0&&e.jsx(M,{className:"bg-red-500 text-white text-xs px-1.5 py-0.5 min-w-[1.25rem] h-5",children:s.unreadCount})]})]})]})},s.id))})})]})}),e.jsx("div",{className:"lg:col-span-8",children:t?e.jsxs(m,{className:"h-full flex flex-col",children:[e.jsxs(f,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(b,{className:"w-10 h-10",children:[e.jsx(w,{src:t.participantAvatar}),e.jsx(y,{children:t.participantName.split(" ").map(s=>s[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:t.participantName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.isOnline?"bg-green-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-xs text-gray-500",children:t.isOnline?"En ligne":"Hors ligne"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(E,{className:"w-4 h-4"})})]})]}),t.missionTitle&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Projet :"})," ",t.missionTitle]})})]}),e.jsx(o,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:S.map(s=>e.jsx("div",{className:`flex ${s.senderId===a.id?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${s.senderId===a.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("p",{className:"text-sm",children:s.content}),e.jsx("p",{className:`text-xs mt-1 ${s.senderId===a.id?"text-blue-100":"text-gray-500"}`,children:j(s.timestamp)})]})},s.id))}),e.jsx("div",{className:"border-t p-4",children:e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex-1",children:e.jsx(v,{value:c,onChange:s=>h(s.target.value),placeholder:"Tapez votre message...",onKeyPress:s=>s.key==="Enter"&&p(),className:"resize-none"})}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx(n,{onClick:p,disabled:!c.trim(),children:e.jsx(k,{className:"w-4 h-4"})})]})})]}):e.jsx(m,{className:"h-full",children:e.jsx(o,{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sélectionnez une conversation"}),e.jsx("p",{className:"text-gray-600",children:"Choisissez une conversation dans la liste pour commencer à discuter"})]})})})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx(m,{className:"max-w-md w-full mx-4",children:e.jsxs(o,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Connexion requise"}),e.jsx("p",{className:"text-gray-600",children:"Connectez-vous pour accéder à vos messages"})]})})})}export{U as default};
