import{r as x,j as e}from"./ui-he1BrmUV.js";import{u as N,F as y,a,b as n,c as o,d as i,e as l,t as C}from"./types-C8ofk9zI.js";import{i as w,U as b,C as S,a as F,e as P,b as I,I as c,f as T}from"./index-D-UGtKLN.js";import{T as D}from"./textarea-Sppa0ssN.js";import{S as z,a as E,b as M,c as R,d as q}from"./select-DDb-DbpR.js";import{B as V}from"./badge-Bsgpf1hE.js";import{s as f}from"./services-B9yTTPPJ.js";import{g as G}from"./services-DYLHMyui.js";import{T as L}from"./trending-up-C6xgXZpG.js";import{M as B}from"./map-pin-CMSmoVVs.js";import{E as U}from"./euro-Li5v3qFH.js";import{L as k}from"./loader-circle-BUa5FwLA.js";import"./vendor-D3F3s8fL.js";import"./index-BelvN6Su.js";import"./chevron-up-DZcsRcC2.js";const A=["Développement web","Design graphique","Marketing digital","Rédaction","Formation","Conseil","Traduction","Maintenance"];function ae(){const[p,h]=x.useState(!1),[u,j]=x.useState(0),{toast:g}=w(),r=N({resolver:C(G),defaultValues:{category:"",need:"",location:"",pricePerParticipant:0,targetParticipants:2,deadline:""}}),d=r.watch("category"),m=r.watch("location");x.useEffect(()=>{d&&m&&f.getGroupInterest(m,d).then(s=>j(s.count))},[d,m]);const v=async s=>{h(!0);try{(await f.createGroupRequest(s)).success&&(g({title:"Demande groupée créée !",description:"Nous allons chercher d'autres participants dans votre zone."}),r.reset(),j(0))}catch{g({title:"Erreur",description:"Impossible de créer la demande groupée. Réessayez.",variant:"destructive"})}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-block p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full mb-4",children:e.jsx(b,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Demandes Groupées"}),e.jsx("p",{className:"text-gray-600",children:"Mutualisez vos besoins pour obtenir des tarifs préférentiels"})]}),e.jsxs(S,{children:[e.jsx(F,{children:e.jsxs(P,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Créer une demande groupée"})]}),u>0&&e.jsxs(V,{variant:"secondary",className:"bg-green-100 text-green-700",children:[u," personnes intéressées"]})]})}),e.jsx(I,{children:e.jsx(y,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(v),className:"space-y-6",children:[e.jsx(a,{control:r.control,name:"category",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Catégorie de service"}),e.jsxs(z,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(i,{children:e.jsx(E,{children:e.jsx(M,{placeholder:"Sélectionnez une catégorie"})})}),e.jsx(R,{children:A.map(t=>e.jsx(q,{value:t,children:t},t))})]}),e.jsx(l,{})]})}),e.jsx(a,{control:r.control,name:"need",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Décrivez votre besoin"}),e.jsx(i,{children:e.jsx(D,{placeholder:"Détaillez le service recherché pour le groupe...",className:"min-h-[100px]",...s})}),e.jsx(l,{})]})}),e.jsx(a,{control:r.control,name:"location",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Zone géographique"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(c,{placeholder:"Ville ou code postal...",className:"pl-10",...s})]})}),e.jsx(l,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(a,{control:r.control,name:"pricePerParticipant",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Prix par participant (€)"}),e.jsx(i,{children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(c,{type:"number",placeholder:"100",className:"pl-10",...s,onChange:t=>s.onChange(Number(t.target.value))})]})}),e.jsx(l,{})]})}),e.jsx(a,{control:r.control,name:"targetParticipants",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Nb participants visé"}),e.jsx(i,{children:e.jsx(c,{type:"number",min:2,placeholder:"5",...s,onChange:t=>s.onChange(Number(t.target.value))})}),e.jsx(l,{})]})})]}),e.jsx(a,{control:r.control,name:"deadline",render:({field:s})=>e.jsxs(n,{children:[e.jsx(o,{children:"Date limite d'inscription"}),e.jsx(i,{children:e.jsx(c,{type:"date",...s})}),e.jsx(l,{})]})}),e.jsx(T,{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 py-3 text-lg font-semibold",children:p?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-5 h-5 mr-2 animate-spin"}),"Création en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5 mr-2"}),"Créer la demande groupée"]})})]})})})]})]})})}export{ae as default};
