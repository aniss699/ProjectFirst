import{j as e,r as D}from"./ui-he1BrmUV.js";import{u as re}from"./useQuery-Bmx4Pxef.js";import{C as z,b as Q,c as K,U as G,d as ne,e as le,f as ce,Z as ie,P as oe,T as de,B as H,g as me,u as ue,L as U,I as xe}from"./index-DGnTWZRa.js";import{d as he}from"./services-B9yTTPPJ.js";import{B as A}from"./badge-YxNVkGyG.js";import{c as J}from"./categories-CJOmrs8V.js";import{E as ge}from"./euro-uvStVa2P.js";import{M as fe}from"./map-pin-DSIGbLXQ.js";import{T as ee}from"./trending-up-D-yVBaY9.js";import{C as pe}from"./clock-CdgIwwmu.js";import{t as v,c as be,e as je,d as ye,g as Y,a as Ne,b as ve,m as Z,f as E}from"./en-US-oEpl4HuW.js";import{f as we}from"./fr-Qfl_UVRO.js";import{R as Me}from"./refresh-cw-BFLf40LW.js";import{T as Ce,C as Se}from"./triangle-alert-CwrNby3j.js";import{S as X,a as O,b as F,c as V,d as C}from"./select-BeCD8kzO.js";import{B as De}from"./brain-Cp9QDTm_.js";import{S as Re}from"./star-CUz35ljD.js";import"./vendor-D3F3s8fL.js";import"./index-BelvN6Su.js";import"./chevron-up-BqQe_GCd.js";function $(a,o){const m=v(a),x=v(o),c=m.getTime()-x.getTime();return c<0?-1:c>0?1:c}function Te(a){return be(a,Date.now())}function Le(a){return o=>{const x=(a?Math[a]:Math.trunc)(o);return x===0?0:x}}function Pe(a,o){return+v(a)-+v(o)}function Ie(a){const o=v(a);return o.setHours(23,59,59,999),o}function Ae(a){const o=v(a);return+Ie(o)==+je(o)}function ke(a,o){const m=v(a),x=v(o),c=$(m,x),b=Math.abs(ye(m,x));let j;if(b<1)j=0;else{m.getMonth()===1&&m.getDate()>27&&m.setDate(30),m.setMonth(m.getMonth()-c*b);let d=$(m,x)===-c;Ae(v(a))&&b===1&&$(a,x)===1&&(d=!1),j=c*(b-Number(d))}return j===0?0:j}function Be(a,o,m){const x=Pe(a,o)/1e3;return Le(m?.roundingMethod)(x)}function Ee(a,o,m){const x=Ne(),c=m?.locale??x.locale??ve,b=2520,j=$(a,o);if(isNaN(j))throw new RangeError("Invalid time value");const d=Object.assign({},m,{addSuffix:m?.addSuffix,comparison:j});let g,S;j>0?(g=v(o),S=v(a)):(g=v(a),S=v(o));const w=Be(S,g),f=(Y(S)-Y(g))/1e3,u=Math.round((w-f)/60);let y;if(u<2)return m?.includeSeconds?w<5?c.formatDistance("lessThanXSeconds",5,d):w<10?c.formatDistance("lessThanXSeconds",10,d):w<20?c.formatDistance("lessThanXSeconds",20,d):w<40?c.formatDistance("halfAMinute",0,d):w<60?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",1,d):u===0?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",u,d);if(u<45)return c.formatDistance("xMinutes",u,d);if(u<90)return c.formatDistance("aboutXHours",1,d);if(u<Z){const p=Math.round(u/60);return c.formatDistance("aboutXHours",p,d)}else{if(u<b)return c.formatDistance("xDays",1,d);if(u<E){const p=Math.round(u/Z);return c.formatDistance("xDays",p,d)}else if(u<E*2)return y=Math.round(u/E),c.formatDistance("aboutXMonths",y,d)}if(y=ke(S,g),y<12){const p=Math.round(u/E);return c.formatDistance("xMonths",p,d)}else{const p=y%12,N=Math.trunc(y/12);return p<3?c.formatDistance("aboutXYears",N,d):p<9?c.formatDistance("overXYears",N,d):c.formatDistance("almostXYears",N+1,d)}}function ze(a,o){return Ee(a,Te(a),o)}function $e({mission:a,onClick:o}){const m=J.find(c=>c.id===a.category),x=a.bids.length>0?a.bids.reduce((c,b)=>c+b.amount,0)/a.bids.length:0;return e.jsxs(z,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-l-4 border-l-blue-500 hover:scale-[1.02] bg-white h-fit",onClick:o,children:[e.jsx(Q,{className:"pb-2 pt-3",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h3",{className:"font-semibold text-base line-clamp-2 flex-1 leading-tight",children:a.title}),e.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[e.jsx(A,{variant:"secondary",className:"shrink-0 text-xs px-2 py-1",children:m?.name||a.category}),a.bids.length>0&&e.jsxs(A,{variant:"outline",className:"text-xs px-2 py-1",children:["🔥 ",a.bids.length]})]})]})}),e.jsxs(K,{className:"py-1",children:[e.jsx("p",{className:"text-gray-600 line-clamp-2 mb-3 text-sm leading-relaxed",children:a.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ge,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"font-medium truncate",children:a.budgetDisplay})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(G,{className:"w-3 h-3 text-purple-600"}),e.jsxs("span",{className:"truncate",children:[a.bids.length," offre",a.bids.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(fe,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"truncate",children:a.location||"Non spécifié"})]}),x>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ee,{className:"w-3 h-3 text-orange-600"}),e.jsxs("span",{className:"font-medium truncate",children:[Math.round(x),"€ moy"]})]})]})]}),e.jsx(ne,{className:"pt-2 pb-3 border-t bg-gray-50/50",children:e.jsxs("div",{className:"flex justify-between items-center w-full text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:ze(new Date(a.createdAt),{addSuffix:!0,locale:we})})]}),e.jsx("div",{className:"text-xs font-medium text-primary truncate ml-2",children:a.clientName})]})})]})}function _e({isLoading:a=!1,hasError:o=!1,isFallbackMode:m=!1,errorMessage:x,onRetry:c,className:b=""}){if(!a&&!o&&!m)return null;const d=a?{icon:Me,color:"blue",title:"Chargement en cours...",message:"Récupération des données",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-800",iconClass:"text-blue-500 animate-spin"}:m?{icon:Ce,color:"orange",title:"Mode dégradé",message:"Le service fonctionne avec des fonctionnalités limitées",bgClass:"bg-orange-50 border-orange-200",textClass:"text-orange-800",iconClass:"text-orange-500"}:o?{icon:Se,color:"red",title:"Problème technique",message:x||"Une erreur est survenue",bgClass:"bg-red-50 border-red-200",textClass:"text-red-800",iconClass:"text-red-500"}:{icon:le,color:"green",title:"Service opérationnel",message:"Tout fonctionne normalement",bgClass:"bg-green-50 border-green-200",textClass:"text-green-800",iconClass:"text-green-500"},g=d.icon;return e.jsx("div",{className:`border rounded-lg p-4 ${d.bgClass} ${b}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:`w-5 h-5 ${d.iconClass}`}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${d.textClass}`,children:d.title}),e.jsx("p",{className:`text-sm ${d.textClass} opacity-80`,children:d.message})]})]}),c&&(o||m)&&e.jsx("button",{onClick:c,className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${d.color==="orange"?"bg-orange-200 hover:bg-orange-300 text-orange-800":"bg-red-200 hover:bg-red-300 text-red-800"}`,children:"Réessayer"})]})})}function qe({providerProfile:a,missions:o,onMissionRecommended:m}){const[x,c]=D.useState([]),[b,j]=D.useState(!1),[d,g]=D.useState({minMatchScore:70,maxCompetition:"high",minWinProbability:40}),S=async()=>{j(!0),await new Promise(s=>setTimeout(s,1500));const i=o.map(s=>{const r=w(s,a),l=f(s,a),I=u(s,a),T=y(s,a),q=r*.35+l*.25+I*.15+T*.25,R=p(s),W=N(q,R,a.rating,a.completedProjects),se=M(s,R,a),te=L(s),ae=P(s,a,{skillsMatch:r,locationMatch:I,competitionLevel:R,winProbability:W});return{missionId:s.id,title:s.title,description:s.description,budget:s.budget,matchScore:q,reasonsToApply:ae,competitionLevel:R,winProbability:W,recommendedBidPrice:se,skillsMatch:r,experienceMatch:l,locationMatch:I,urgency:te,clientProfile:{name:s.clientName,rating:4.2+Math.random()*.8,projectsPosted:Math.floor(Math.random()*20)+1,avgBudget:s.budget*(.8+Math.random()*.4)}}}).sort((s,r)=>r.matchScore-s.matchScore).slice(0,10);c(i),j(!1)},w=(t,i)=>{const s=n(t),r=i.skills.map(T=>T.toLowerCase());let l=0,I=s.length;return s.forEach(T=>{r.some(R=>R.includes(T)||T.includes(R)||h(T,R)>.7)&&l++}),Math.min(100,l/Math.max(I,1)*100)},f=(t,i)=>{let s=0;return i.completedProjects>=50?s+=40:i.completedProjects>=20?s+=30:i.completedProjects>=5?s+=20:s+=10,i.categories.includes(t.category)&&(s+=30),s+=i.rating/5*30,Math.min(100,s)},u=(t,i)=>{if(!t.location||!i.location)return 70;const s=t.location.toLowerCase(),r=i.location.toLowerCase();if(s===r)return 100;if(s.includes(r)||r.includes(s))return 85;const l=Math.random()*500;return l<50?90:l<100?75:l<200?60:40},y=(t,i)=>{const s=t.budget,r=i.hourlyRate,l=s/r;return l>=20&&l<=100?100:l>=10&&l<=150?80:l>=5&&l<=200?60:40},p=t=>{const i=t.bids?.length||0,s=Math.floor((Date.now()-new Date(t.createdAt).getTime())/(1e3*60*60*24));return i>10||s>7?"high":i>5||s>3?"medium":"low"},N=(t,i,s,r)=>{let l=t;return i==="low"?l*=1.3:i==="high"&&(l*=.7),l+=s/5*10,l+=Math.min(15,r*.2),Math.min(95,Math.max(5,l))},M=(t,i,s)=>{let l=t.budget;return i==="high"?l*=.85:i==="low"?l*=.95:l*=.9,s.rating>=4.5&&s.completedMissions>=20&&(l*=1.05),Math.round(l)},L=t=>{if(["urgent","asap","rapidement","immédiat","express"].some(l=>t.title.toLowerCase().includes(l)||t.description.toLowerCase().includes(l)))return"high";const r=Math.floor((Date.now()-new Date(t.createdAt).getTime())/(1e3*60*60*24));return r<=1?"high":r<=3?"medium":"low"},P=(t,i,s)=>{const r=[];return s.skillsMatch>=80&&r.push("Parfaite correspondance avec vos compétences"),s.competitionLevel==="low"&&r.push("Faible concurrence - grande chance de succès"),s.winProbability>=70&&r.push(`${Math.round(s.winProbability)}% de probabilité de gagner`),t.budget>=i.hourlyRate*20&&r.push("Budget attractif pour ce type de projet"),s.locationMatch>=90&&r.push("Client dans votre zone géographique"),r.slice(0,3)},n=t=>{const i=(t.title+" "+t.description+" "+t.category).toLowerCase(),s=["le","la","les","un","une","des","et","ou","mais","donc"];return i.split(/[\s,;.!?]+/).filter(r=>r.length>3&&!s.includes(r)).slice(0,10)},h=(t,i)=>{const s=t.length>i.length?t:i,r=t.length>i.length?i:t;if(s.length===0)return 1;const l=k(s,r);return(s.length-l)/s.length},k=(t,i)=>{const s=[];for(let r=0;r<=i.length;r++)s[r]=[r];for(let r=0;r<=t.length;r++)s[0][r]=r;for(let r=1;r<=i.length;r++)for(let l=1;l<=t.length;l++)i.charAt(r-1)===t.charAt(l-1)?s[r][l]=s[r-1][l-1]:s[r][l]=Math.min(s[r-1][l-1]+1,s[r][l-1]+1,s[r-1][l]+1);return s[i.length][t.length]},B=t=>{switch(t){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},_=t=>{switch(t){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return D.useEffect(()=>{o.length>0&&S()},[o,a]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{children:e.jsx(Q,{children:e.jsxs(ce,{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-6 h-6 text-purple-600"}),e.jsx("span",{children:"Moteur de Matching IA"}),e.jsxs(A,{variant:"secondary",className:"bg-purple-100 text-purple-700",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Algorithm v2.0"]})]})})}),b?e.jsx(z,{children:e.jsxs(K,{className:"py-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-600",children:["Analyse de ",o.length," missions avec notre IA..."]})]})}):e.jsx("div",{className:"space-y-4",children:x.map((t,i)=>e.jsx(z,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(K,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.title}),e.jsxs(A,{className:`px-2 py-1 text-xs ${B(t.competitionLevel)}`,children:["Concurrence ",t.competitionLevel]}),e.jsx(A,{className:`px-2 py-1 text-xs ${_(t.urgency)}`,children:t.urgency==="high"?"Urgent":t.urgency==="medium"?"Normal":"Pas pressé"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:t.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 mb-1",children:[t.budget,"€"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Prix suggéré: ",t.recommendedBidPrice,"€"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Score de correspondance"}),e.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[Math.round(t.matchScore),"%"]})]}),e.jsx(oe,{value:t.matchScore,className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-gray-600",children:[e.jsxs("div",{children:["Compétences: ",Math.round(t.skillsMatch),"%"]}),e.jsxs("div",{children:["Expérience: ",Math.round(t.experienceMatch),"%"]}),e.jsxs("div",{children:["Localisation: ",Math.round(t.locationMatch),"%"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center",children:[e.jsx(de,{className:"w-4 h-4 mr-1 text-blue-600"}),"Pourquoi postuler"]}),e.jsx("ul",{className:"space-y-1",children:t.reasonsToApply.map((s,r)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"text-green-500 mr-2",children:"•"}),s]},r))})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),t.clientProfile.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Re,{className:"w-4 h-4 mr-1 text-yellow-500"}),t.clientProfile.rating.toFixed(1)]}),e.jsxs("div",{children:[t.clientProfile.projectsPosted," projets postés"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"font-medium",children:[Math.round(t.winProbability),"% de succès"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Rang #",i+1," sur ",x.length]}),e.jsx(H,{onClick:()=>m?.(t),className:"bg-purple-600 hover:bg-purple-700",children:"Voir la mission"})]})]})},t.missionId))})]})}function cs(){const{user:a}=me(),[,o]=ue(),[m,x]=D.useState(!1),[c,b]=D.useState(0),[j,d]=D.useState(0),[g,S]=D.useState({category:"all",budget:"all",location:"",sort:"newest"}),{data:w,isLoading:f,error:u,refetch:y}=re({queryKey:["/api/missions"],queryFn:async()=>{console.log("🔄 Début requête missions API avec mappers...");try{const n=await he.getMissions();return console.log("✅ Missions normalisées récupérées:",n.missions.length),n}catch(n){return console.error("❌ Erreur réseau:",n),{missions:[],metadata:{total:0,has_errors:!0,error_message:`Erreur réseau: ${n instanceof Error?n.message:"Unknown error"}`,fallback_mode:!0}}}},refetchInterval:12e4,retry:(n,h)=>(console.log(`🔄 Tentative ${n+1}/3 après erreur:`,h),n<2),retryDelay:n=>{const h=Math.min(1e3*Math.pow(2,n),1e4);return console.log(`⏳ Retry dans ${h}ms`),h},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,meta:{errorPolicy:"soft"}}),p=w?.missions||[],N=w?.metadata||{total:0},M=N.fallback_mode||!1;console.log("🏪 Marketplace - État actuel:",{missionsCount:p.length,isLoading:f,hasError:!!u,errorMessage:u?.message}),D.useEffect(()=>{if(u&&!f&&c<3&&Date.now()-j>5e3){const B=Math.min(2e3*Math.pow(2,c),1e4);console.log(`🔄 Retry automatique #${c+1} dans ${B}ms`);const _=setTimeout(()=>{console.log(`🔄 Exécution retry automatique #${c+1}`),b(t=>t+1),d(Date.now()),y()},B);return()=>clearTimeout(_)}},[u,f,c,j,y]),D.useEffect(()=>{!u&&!f&&p.length>0&&b(0)},[u,f,p.length]);const L=p.filter(n=>{if(g.category&&g.category!=="all"&&n.category!==g.category||g.location&&!n.location?.toLowerCase().includes(g.location.toLowerCase()))return!1;if(g.budget&&g.budget!=="all"){const h=n.budget;switch(g.budget){case"0-500":return h>=0&&h<=500;case"500-2000":return h>500&&h<=2e3;case"2000-5000":return h>2e3&&h<=5e3;case"5000+":return h>5e3;default:return!0}}return!0}).sort((n,h)=>{switch(g.sort){case"newest":return new Date(h.createdAt).getTime()-new Date(n.createdAt).getTime();case"budget-high":return h.budget-n.budget;case"budget-low":return n.budget-h.budget;case"bids":return h.bids.length-n.bids.length;default:return 0}}),P=(n,h)=>{S(k=>({...k,[n]:h}))};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2 sm:mb-4",children:"Marketplace des Projets"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 mb-4",children:"Découvrez et soumissionnez sur les projets disponibles"}),e.jsx(_e,{isLoading:f,hasError:!!u&&!M,isFallbackMode:M,errorMessage:N?.error_message,onRetry:()=>{console.log("🔄 Retry depuis la bannière"),y()},className:"mb-4"})]}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-white via-blue-50/30 to-purple-50/20 rounded-3xl shadow-xl border border-blue-100/50 p-6 sm:p-8 sticky top-24 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Filtrer les projets"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Catégorie"]}),e.jsxs(X,{value:g.category,onValueChange:n=>P("category",n),children:[e.jsx(O,{className:"bg-white/80 border-gray-200 hover:border-blue-400 transition-colors",children:e.jsx(F,{placeholder:"Toutes les catégories"})}),e.jsxs(V,{children:[e.jsx(C,{value:"all",children:"Toutes les catégories"}),J.map(n=>e.jsx(C,{value:n.id,children:n.name},n.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Budget"]}),e.jsxs(X,{value:g.budget,onValueChange:n=>P("budget",n),children:[e.jsx(O,{className:"bg-white/80 border-gray-200 hover:border-green-400 transition-colors",children:e.jsx(F,{placeholder:"Tous les budgets"})}),e.jsxs(V,{children:[e.jsx(C,{value:"all",children:"Tous les budgets"}),e.jsx(C,{value:"0-500",children:"0 - 500€"}),e.jsx(C,{value:"500-2000",children:"500 - 2 000€"}),e.jsx(C,{value:"2000-5000",children:"2 000 - 5 000€"}),e.jsx(C,{value:"5000+",children:"5 000€+"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Localisation"]}),e.jsx(xe,{type:"text",placeholder:"Ville, région...",value:g.location,onChange:n=>P("location",n.target.value),className:"bg-white/80 border-gray-200 hover:border-purple-400 focus:border-purple-500 transition-colors"})]})]}),e.jsx(H,{onClick:()=>S({category:"all",budget:"all",location:"",sort:"newest"}),variant:"outline",className:"w-full border-gray-300 hover:bg-gray-50 transition-all duration-200 hover:shadow-md",children:"🔄 Réinitialiser les filtres"})]})}),e.jsxs("div",{className:"lg:w-3/4 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-4 sm:mb-0",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Toutes les missions (",L.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Chargement..."]}),!f&&!u&&!M&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Service actif"]}),M&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),"Mode dégradé"]}),N?.total!==void 0&&e.jsxs("div",{className:"text-sm text-gray-500",children:[N.total," total",N.has_errors&&" (avec erreurs)"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[a?.type==="provider"&&e.jsx(H,{onClick:()=>x(!m),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 w-full sm:w-auto",children:"🤖 Matching IA"}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:"Trier par:"}),e.jsxs(X,{value:g.sort,onValueChange:n=>P("sort",n),children:[e.jsx(O,{className:"w-full sm:w-40",children:e.jsx(F,{})}),e.jsxs(V,{children:[e.jsx(C,{value:"newest",children:"Plus récent"}),e.jsx(C,{value:"budget-high",children:"Budget décroissant"}),e.jsx(C,{value:"budget-low",children:"Budget croissant"}),e.jsx(C,{value:"bids",children:"Nombre d'offres"})]})]})]})]})]}),m&&a?.type==="provider"&&e.jsx("div",{className:"mb-8",children:e.jsx(qe,{providerProfile:{id:a.id,skills:["React","Node.js","TypeScript","Python"],location:"Paris",rating:4.7,completedProjects:28,portfolio:[],hourlyRate:65,categories:["web-development","mobile-development"]},missions:L,onMissionRecommended:n=>{o(`/missions/${n.missionId}`),x(!1)}})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[f&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Chargement des missions..."})]}),(u||M)&&!f&&e.jsx("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-2xl p-8 mx-auto max-w-2xl",children:[e.jsx("div",{className:"text-orange-500 mb-4",children:M?"⚠️":"❌"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:M?"Mode dégradé activé":"Problème de chargement"}),e.jsx("p",{className:"text-gray-700 text-base mb-4",children:M?"Les missions ne peuvent pas être chargées normalement. Le système fonctionne en mode dégradé.":"Impossible de charger les missions pour le moment."}),N.error_message&&e.jsxs("div",{className:"bg-white/70 rounded-lg p-4 mb-4 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Détail:"})," ",N.error_message]}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-6",children:[e.jsx("button",{onClick:()=>{console.log("🔄 Retry manuel déclenché"),y()},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"🔄 Réessayer"}),e.jsx("button",{onClick:()=>{console.log("🏠 Retour accueil"),window.location.href="/"},className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"🏠 Retour accueil"})]}),e.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[e.jsxs("p",{className:"mb-2",children:["💡 ",e.jsx("strong",{children:"Suggestions:"})]}),e.jsxs("ul",{className:"text-left space-y-1 max-w-md mx-auto",children:[e.jsx("li",{children:"• Vérifiez votre connexion internet"}),e.jsx("li",{children:"• Essayez de recharger dans quelques minutes"}),e.jsx("li",{children:"• Contactez le support si le problème persiste"})]})]})]})}),M&&!f&&p.length===0&&e.jsx("div",{className:"sm:col-span-2 lg:col-span-3",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6 mb-8",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"🎯 Missions de démonstration"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"En attendant le retour du service, voici quelques exemples de missions typiques :"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"demo-1",title:"Développement site e-commerce",description:"Création d'un site e-commerce moderne avec React et Node.js",category:"developpement",budget:"3500",location:"Remote",status:"open",createdAt:new Date().toISOString(),bids:[]},{id:"demo-2",title:"Design d'application mobile",description:"Design UI/UX pour une application de fitness",category:"design",budget:"2200",location:"Paris",status:"open",createdAt:new Date().toISOString(),bids:[]}].map((n,h)=>e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-blue-100",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:n.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:n.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:[n.budget,"€"]}),e.jsx("span",{className:"text-gray-500",children:n.location})]})]},h))})]})}),!f&&!u&&L.map(n=>e.jsx($e,{mission:n,onClick:()=>o(`/missions/${n.id}`)},n.id)),!f&&!u&&L.length===0&&e.jsxs("div",{className:"text-center py-12 sm:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-gray-300 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L10 8.586 8.707 7.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("p",{className:"text-gray-500 text-lg",children:["Aucune mission trouvée (",p.length," missions totales)"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Essayez de modifier vos filtres"})]})]})]})]})}export{cs as default};
